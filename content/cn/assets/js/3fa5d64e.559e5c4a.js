"use strict";(self.webpackChunkhudi=self.webpackChunkhudi||[]).push([[97658],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var i=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=i.createContext({}),d=function(e){var t=i.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=d(e.components);return i.createElement(s.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(a),c=n,m=u["".concat(s,".").concat(c)]||u[c]||h[c]||r;return a?i.createElement(m,o(o({ref:t},p),{},{components:a})):i.createElement(m,o({ref:t},p))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,o=new Array(r);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:n,o[1]=l;for(var d=2;d<r;d++)o[d]=a[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,a)}c.displayName="MDXCreateElement"},60298:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var i=a(87462),n=(a(67294),a(3905));const r={title:"Older Releases",sidebar_position:7,layout:"releases",toc:!0,last_modified_at:new Date("2020-05-28T15:40:00.000Z")},o=void 0,l={unversionedId:"older-releases",id:"older-releases",title:"Older Releases",description:"This page contains older release information, for bookkeeping purposes. It's recommended that you upgrade to one of the",source:"@site/releases/older-releases.md",sourceDirName:".",slug:"/older-releases",permalink:"/cn/releases/older-releases",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"Older Releases",sidebar_position:7,layout:"releases",toc:!0,last_modified_at:"2020-05-28T15:40:00.000Z"},sidebar:"releases",previous:{title:"Release 0.10.1",permalink:"/cn/releases/release-0.10.1"}},s=[{value:"Release 0.13.0 (docs)",id:"release-0130-docs",children:[],level:2},{value:"Migration Guide: Overview",id:"migration-guide-overview",children:[],level:2},{value:"Migration Guide: Breaking Changes",id:"migration-guide-breaking-changes",children:[{value:"Bundle Updates",id:"bundle-updates",children:[{value:"Spark bundle Support",id:"spark-bundle-support",children:[],level:4},{value:"Utilities Bundle Change",id:"utilities-bundle-change",children:[],level:4},{value:"New Flink Bundle",id:"new-flink-bundle",children:[],level:4}],level:3},{value:"Lazy File Index in Spark",id:"lazy-file-index-in-spark",children:[],level:3},{value:"Checkpoint Management in Spark Structured Streaming",id:"checkpoint-management-in-spark-structured-streaming",children:[],level:3},{value:"ORC Support in Spark",id:"orc-support-in-spark",children:[],level:3},{value:"Mandatory Record Key Field",id:"mandatory-record-key-field",children:[],level:3}],level:2},{value:"Migration Guide: Behavior Changes",id:"migration-guide-behavior-changes",children:[{value:"Schema Handling in Write Path",id:"schema-handling-in-write-path",children:[],level:3},{value:"Removal of Default Shuffle Parallelism",id:"removal-of-default-shuffle-parallelism",children:[],level:3},{value:"Simple Write Executor as Default",id:"simple-write-executor-as-default",children:[],level:3},{value:"<code>NONE</code> Sort Mode for Bulk Insert to Match Parquet Writes",id:"none-sort-mode-for-bulk-insert-to-match-parquet-writes",children:[],level:3},{value:"Meta Sync Failure in Deltastreamer",id:"meta-sync-failure-in-deltastreamer",children:[],level:3},{value:"No Override of Internal Metadata Table Configs",id:"no-override-of-internal-metadata-table-configs",children:[],level:3},{value:"Spark SQL CTAS Performance Fix",id:"spark-sql-ctas-performance-fix",children:[],level:3},{value:"Flink CkpMetadata",id:"flink-ckpmetadata",children:[],level:3}],level:2},{value:"Release Highlights",id:"release-highlights",children:[{value:"Metaserver",id:"metaserver",children:[],level:3},{value:"Change Data Capture",id:"change-data-capture",children:[],level:3},{value:"Optimizing Record Payload handling",id:"optimizing-record-payload-handling",children:[],level:3},{value:"New Source Support in Deltastreamer",id:"new-source-support-in-deltastreamer",children:[{value:"Proto Kafka Source",id:"proto-kafka-source",children:[],level:4},{value:"GCS Incremental Source",id:"gcs-incremental-source",children:[],level:4},{value:"Pulsar Source",id:"pulsar-source",children:[],level:4}],level:3},{value:"Support for Partial Payload Update",id:"support-for-partial-payload-update",children:[],level:3},{value:"Consistent Hashing Index",id:"consistent-hashing-index",children:[],level:3},{value:"Early Conflict Detection for Multi-Writer",id:"early-conflict-detection-for-multi-writer",children:[],level:3},{value:"Lock-Free Message Queue in Writing Data",id:"lock-free-message-queue-in-writing-data",children:[],level:3},{value:"Hudi CLI Bundle",id:"hudi-cli-bundle",children:[],level:3},{value:"Support for Flink 1.16",id:"support-for-flink-116",children:[],level:3},{value:"Json Schema Converter",id:"json-schema-converter",children:[],level:3},{value:"Providing Hudi Configs via Spark SQL Config",id:"providing-hudi-configs-via-spark-sql-config",children:[],level:3}],level:2},{value:"Known Regressions",id:"known-regressions",children:[],level:2},{value:"Raw Release Notes",id:"raw-release-notes",children:[],level:2},{value:"Release 0.12.1 (docs)",id:"release-0121-docs",children:[],level:2},{value:"Long Term Support",id:"long-term-support",children:[],level:2},{value:"Migration Guide",id:"migration-guide",children:[],level:2},{value:"Release Highlights",id:"release-highlights-1",children:[{value:"Improve Hudi Cli",id:"improve-hudi-cli",children:[],level:3},{value:"Fix invalid record key stats in Parquet metadata",id:"fix-invalid-record-key-stats-in-parquet-metadata",children:[],level:3},{value:"Bug fixes",id:"bug-fixes",children:[],level:3}],level:2},{value:"Known Regressions",id:"known-regressions-1",children:[],level:2},{value:"Raw Release Notes",id:"raw-release-notes-1",children:[],level:2},{value:"Release 0.12.0 (docs)",id:"release-0120-docs",children:[],level:2},{value:"Long Term Support",id:"long-term-support-1",children:[],level:2},{value:"Migration Guide",id:"migration-guide-1",children:[{value:"Configuration Updates",id:"configuration-updates",children:[],level:3},{value:"API Updates",id:"api-updates",children:[],level:3},{value:"Fallback Partition",id:"fallback-partition",children:[],level:3},{value:"Bundle Updates",id:"bundle-updates-1",children:[],level:3}],level:2},{value:"Release Highlights",id:"release-highlights-2",children:[{value:"Presto-Hudi Connector",id:"presto-hudi-connector",children:[],level:3},{value:"Archival Beyond Savepoint",id:"archival-beyond-savepoint",children:[],level:3},{value:"File system based Lock Provider",id:"file-system-based-lock-provider",children:[],level:3},{value:"Deltastreamer Termination Strategy",id:"deltastreamer-termination-strategy",children:[],level:3},{value:"Spark 3.3 Support",id:"spark-33-support",children:[],level:3},{value:"Spark SQL Support Improvements",id:"spark-sql-support-improvements",children:[],level:3},{value:"Flink 1.15 Support",id:"flink-115-support",children:[],level:3},{value:"Flink Integration Improvements",id:"flink-integration-improvements",children:[],level:3},{value:"Performance Improvements",id:"performance-improvements",children:[],level:3}],level:2},{value:"Known Regressions:",id:"known-regressions-2",children:[],level:2},{value:"Raw Release Notes",id:"raw-release-notes-2",children:[],level:2},{value:"Release 0.11.0 (docs)",id:"release-0110-docs",children:[],level:2},{value:"Migration Guide",id:"migration-guide-2",children:[{value:"Bundle usage updates",id:"bundle-usage-updates",children:[],level:3},{value:"Configuration updates",id:"configuration-updates-1",children:[],level:3}],level:2},{value:"Release Highlights",id:"release-highlights-3",children:[{value:"Multi-Modal Index",id:"multi-modal-index",children:[],level:3},{value:"Data Skipping with Metadata Table",id:"data-skipping-with-metadata-table",children:[],level:3},{value:"Async Indexer",id:"async-indexer",children:[],level:3},{value:"Spark DataSource Improvements",id:"spark-datasource-improvements",children:[],level:3},{value:"Schema-on-read for Spark",id:"schema-on-read-for-spark",children:[],level:3},{value:"Spark SQL Improvements",id:"spark-sql-improvements",children:[],level:3},{value:"Spark Versions and Bundles",id:"spark-versions-and-bundles",children:[],level:3},{value:"Slim Utilities Bundle",id:"slim-utilities-bundle",children:[],level:3},{value:"Flink Integration Improvements",id:"flink-integration-improvements-1",children:[],level:3},{value:"Google BigQuery Integration",id:"google-bigquery-integration",children:[],level:3},{value:"AWS Glue Meta Sync",id:"aws-glue-meta-sync",children:[],level:3},{value:"DataHub Meta Sync",id:"datahub-meta-sync",children:[],level:3},{value:"Encryption",id:"encryption",children:[],level:3},{value:"Bucket Index",id:"bucket-index",children:[],level:3},{value:"Savepoint &amp; Restore",id:"savepoint--restore",children:[],level:3},{value:"Pulsar Write Commit Callback",id:"pulsar-write-commit-callback",children:[],level:3},{value:"HiveSchemaProvider",id:"hiveschemaprovider",children:[],level:3}],level:2},{value:"Known Regression",id:"known-regression",children:[],level:2},{value:"Raw Release Notes",id:"raw-release-notes-3",children:[],level:2},{value:"Release 0.10.0 (docs)",id:"release-0100-docs",children:[],level:2},{value:"Migration Guide",id:"migration-guide-3",children:[{value:"Prerequisites for enabling metadata table",id:"prerequisites-for-enabling-metadata-table",children:[],level:3},{value:"Upgrade steps",id:"upgrade-steps",children:[],level:3},{value:"Spark-SQL primary key requirements",id:"spark-sql-primary-key-requirements",children:[],level:3}],level:2},{value:"Release Highlights",id:"release-highlights-4",children:[{value:"Kafka Connect",id:"kafka-connect",children:[],level:3},{value:"Z-Ordering, Hilbert Curves and Data Skipping",id:"z-ordering-hilbert-curves-and-data-skipping",children:[],level:3},{value:"Debezium Deltastreamer sources",id:"debezium-deltastreamer-sources",children:[],level:3},{value:"External config file support",id:"external-config-file-support",children:[],level:3},{value:"Metadata table",id:"metadata-table",children:[],level:3},{value:"Documentation overhaul",id:"documentation-overhaul",children:[],level:3}],level:2},{value:"Writer side improvements",id:"writer-side-improvements",children:[{value:"DynamoDB based lock provider",id:"dynamodb-based-lock-provider",children:[],level:3},{value:"Default flips",id:"default-flips",children:[],level:3},{value:"Spark SQL improvements",id:"spark-sql-improvements-1",children:[],level:3}],level:2},{value:"Query side improvements",id:"query-side-improvements",children:[],level:2},{value:"Flink Integration Improvements",id:"flink-integration-improvements-2",children:[],level:2},{value:"Ecosystem",id:"ecosystem",children:[{value:"DBT support",id:"dbt-support",children:[],level:3},{value:"Monitoring",id:"monitoring",children:[],level:3},{value:"DevEx",id:"devex",children:[],level:3},{value:"Repair tool for dangling data files",id:"repair-tool-for-dangling-data-files",children:[],level:3}],level:2},{value:"Raw Release Notes",id:"raw-release-notes-4",children:[],level:2},{value:"Release 0.9.0 (docs)",id:"release-090-docs",children:[],level:2},{value:"Migration Guide for this release",id:"migration-guide-for-this-release",children:[],level:2},{value:"Release Highlights",id:"release-highlights-5",children:[{value:"Spark SQL DML and DDL Support",id:"spark-sql-dml-and-ddl-support",children:[],level:3},{value:"Query side improvements",id:"query-side-improvements-1",children:[],level:3},{value:"Writer side improvements",id:"writer-side-improvements-1",children:[],level:3},{value:"Flink Integration Improvements",id:"flink-integration-improvements-3",children:[],level:3},{value:"DeltaStreamer",id:"deltastreamer",children:[],level:3}],level:2},{value:"Raw Release Notes",id:"raw-release-notes-5",children:[],level:2},{value:"Release 0.8.0 (docs)",id:"release-080-docs",children:[],level:2},{value:"Migration Guide for this release",id:"migration-guide-for-this-release-1",children:[],level:2},{value:"Release Highlights",id:"release-highlights-6",children:[{value:"Flink Integration",id:"flink-integration",children:[],level:3},{value:"Parallel Writers Support",id:"parallel-writers-support",children:[],level:3},{value:"Writer side improvements",id:"writer-side-improvements-2",children:[],level:3},{value:"Query side improvements",id:"query-side-improvements-2",children:[],level:3},{value:"Raw Release Notes",id:"raw-release-notes-6",children:[],level:3}],level:2},{value:"Release 0.7.0 (docs)",id:"release-070-docs",children:[],level:2},{value:"Migration Guide for this release",id:"migration-guide-for-this-release-2",children:[],level:2},{value:"Release Highlights",id:"release-highlights-7",children:[{value:"Clustering",id:"clustering",children:[],level:3},{value:"Metadata Table",id:"metadata-table-1",children:[],level:3},{value:"Java/Flink Writers",id:"javaflink-writers",children:[],level:3},{value:"Writer side improvements",id:"writer-side-improvements-3",children:[],level:3},{value:"Query side improvements",id:"query-side-improvements-3",children:[],level:3},{value:"Raw Release Notes",id:"raw-release-notes-7",children:[],level:3}],level:2},{value:"Release 0.6.0 (docs)",id:"release-060-docs",children:[],level:2},{value:"Migration Guide for this release",id:"migration-guide-for-this-release-3",children:[],level:2},{value:"Release Highlights",id:"release-highlights-8",children:[{value:"Writer side improvements:",id:"writer-side-improvements-4",children:[],level:3},{value:"Query side improvements:",id:"query-side-improvements-4",children:[],level:3},{value:"Usability:",id:"usability",children:[],level:3}],level:2},{value:"Raw Release Notes",id:"raw-release-notes-8",children:[],level:2},{value:"Release 0.5.3 (docs)",id:"release-053-docs",children:[],level:2},{value:"Migration Guide for this release",id:"migration-guide-for-this-release-4",children:[],level:2},{value:"Release Highlights",id:"release-highlights-9",children:[],level:2},{value:"Raw Release Notes",id:"raw-release-notes-9",children:[],level:2},{value:"Release 0.5.2-incubating (docs)",id:"release-052-incubating-docs",children:[{value:"Migration Guide for this release",id:"migration-guide-for-this-release-5",children:[],level:3},{value:"Release Highlights",id:"release-highlights-10",children:[],level:3},{value:"Raw Release Notes",id:"raw-release-notes-10",children:[],level:3}],level:2},{value:"Release 0.5.1-incubating (docs)",id:"release-051-incubating-docs",children:[{value:"Migration Guide for this release",id:"migration-guide-for-this-release-6",children:[],level:3},{value:"Release Highlights",id:"release-highlights-11",children:[],level:3},{value:"Raw Release Notes",id:"raw-release-notes-11",children:[],level:3}],level:2},{value:"Release 0.5.0-incubating (docs)",id:"release-050-incubating-docs",children:[{value:"Release Highlights",id:"release-highlights-12",children:[],level:3},{value:"Migration Guide for this release",id:"migration-guide-for-this-release-7",children:[],level:3},{value:"Raw Release Notes",id:"raw-release-notes-12",children:[],level:3}],level:2},{value:"Release 0.4.7",id:"release-047",children:[{value:"Release Highlights",id:"release-highlights-13",children:[],level:3},{value:"PR LIST",id:"pr-list",children:[],level:3}],level:2}],d={toc:s},p="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,i.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"This page contains older release information, for bookkeeping purposes. It's recommended that you upgrade to one of the\nmore recent releases listed ",(0,n.kt)("a",{parentName:"p",href:"/releases/download"},"here")),(0,n.kt)("h2",{id:"release-0130-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.13.0"},"Release 0.13.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/quick-start-guide"},"docs"),")"),(0,n.kt)("p",null,"Apache Hudi 0.13.0 release introduces a number of new features including ",(0,n.kt)("a",{parentName:"p",href:"#metaserver"},"Metaserver"),",\n",(0,n.kt)("a",{parentName:"p",href:"#change-data-capture"},"Change Data Capture"),", ",(0,n.kt)("a",{parentName:"p",href:"#optimizing-record-payload-handling"},"new Record Merge API"),",\n",(0,n.kt)("a",{parentName:"p",href:"#new-source-support-in-deltastreamer"},"new sources for Deltastreamer")," and more.  While there is no table version upgrade\nrequired for this release, users are expected to take actions by following the ",(0,n.kt)("a",{parentName:"p",href:"#migration-guide-overview"},"Migration Guide"),"\ndown below on relevant ",(0,n.kt)("a",{parentName:"p",href:"#migration-guide-breaking-changes"},"breaking changes")," and\n",(0,n.kt)("a",{parentName:"p",href:"#migration-guide-behavior-changes"},"behavior changes")," before using 0.13.0 release."),(0,n.kt)("h2",{id:"migration-guide-overview"},"Migration Guide: Overview"),(0,n.kt)("p",null,"This release keeps the same table version (",(0,n.kt)("inlineCode",{parentName:"p"},"5"),") as ",(0,n.kt)("a",{parentName:"p",href:"/releases/release-0.12.2"},"0.12.0 release"),", and there is no need for\na table version upgrade if you are upgrading from 0.12.0.  There are a few\n",(0,n.kt)("a",{parentName:"p",href:"#migration-guide-breaking-changes"},"breaking changes")," and ",(0,n.kt)("a",{parentName:"p",href:"#migration-guide-behavior-changes"},"behavior changes")," as\ndescribed below, and users are expected to take action accordingly before using 0.13.0 release."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"If migrating from an older release (pre 0.12.0), please also check the upgrade instructions from each older release in\nsequence."))),(0,n.kt)("h2",{id:"migration-guide-breaking-changes"},"Migration Guide: Breaking Changes"),(0,n.kt)("h3",{id:"bundle-updates"},"Bundle Updates"),(0,n.kt)("h4",{id:"spark-bundle-support"},"Spark bundle Support"),(0,n.kt)("p",null,"From now on, ",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-spark3.2-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-spark3.2-bundle"))," works\nwith Apache Spark 3.2.1 and newer versions for Spark 3.2.x.  The support for Spark 3.2.0 with\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-spark3.2-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-spark3.2-bundle"))," is\ndropped because of the Spark implementation change of ",(0,n.kt)("inlineCode",{parentName:"p"},"getHive")," method of ",(0,n.kt)("inlineCode",{parentName:"p"},"HiveClientImpl")," which is incompatible between\nSpark version 3.2.0 and 3.2.1."),(0,n.kt)("h4",{id:"utilities-bundle-change"},"Utilities Bundle Change"),(0,n.kt)("p",null,"The AWS and GCP bundle jars are separated from\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-utilities-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-utilities-bundle")),". The user would need\nto use ",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-aws-bundle"},(0,n.kt)("strong",{parentName:"a"},(0,n.kt)("inlineCode",{parentName:"strong"},"hudi-aws-bundle")))," or\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-gcp-bundle"},(0,n.kt)("strong",{parentName:"a"},(0,n.kt)("inlineCode",{parentName:"strong"},"hudi-gcp-bundle")))," along with\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-utilities-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-utilities-bundle"))," while using the\ncloud services."),(0,n.kt)("h4",{id:"new-flink-bundle"},"New Flink Bundle"),(0,n.kt)("p",null,"Hudi is now supported on Flink 1.16.x with the new\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-flink1.16-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-flink1.16-bundle")),"."),(0,n.kt)("h3",{id:"lazy-file-index-in-spark"},"Lazy File Index in Spark"),(0,n.kt)("p",null,"Hudi's File Index in Spark is switched to be listed lazily ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"by default")),": this entails that it would ",(0,n.kt)("strong",{parentName:"p"},"only")," be listing\npartitions that are requested by the query (i.e., after partition-pruning) as opposed to always listing the whole table\nbefore this release. This is expected to bring considerable performance improvement for large tables."),(0,n.kt)("p",null,"A new configuration property is added if the user wants to change the listing behavior:\n",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.read.file.index.listing.mode")," (now default to ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"lazy")),"). There are two possible values that you can\nset:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"eager")),": This lists all partition paths and corresponding file slices within them eagerly, during initialization.\nThis is the default behavior prior 0.13.0."),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"If a Hudi table has 1000 partitions, the eager mode lists the files under all of them when constructing the file index.  "))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"lazy")),": The partitions and file-slices within them will be listed lazily, allowing partition pruning predicates to\nbe pushed down appropriately, therefore only listing partitions after these have already been pruned."),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The files are not listed under the partitions when the File Index is initialized. The files are listed only under\ntargeted partition(s) after partition pruning using predicates (e.g., ",(0,n.kt)("inlineCode",{parentName:"li"},"datestr=2023-02-19"),") in queries.")))),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"To preserve the behavior pre 0.13.0, the user needs to set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.read.file.index.listing.mode=eager"),"."))),(0,n.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Breaking Change")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"The ",(0,n.kt)("strong",{parentName:"p"},"breaking change")," occurs only in cases when the table has ",(0,n.kt)("strong",{parentName:"p"},"BOTH"),": multiple partition columns AND partition\nvalues contain slashes that are not URL-encoded."))),(0,n.kt)("p",null,"For example let's assume we want to parse two partition columns - ",(0,n.kt)("inlineCode",{parentName:"p"},"month")," (",(0,n.kt)("inlineCode",{parentName:"p"},"2022/01"),") and ",(0,n.kt)("inlineCode",{parentName:"p"},"day")," (",(0,n.kt)("inlineCode",{parentName:"p"},"03"),"), from the\npartition path ",(0,n.kt)("inlineCode",{parentName:"p"},"2022/01/03"),". Since there is a mismatch between the number of partition columns (2 here - ",(0,n.kt)("inlineCode",{parentName:"p"},"month")," and\n",(0,n.kt)("inlineCode",{parentName:"p"},"day"),") and the number of components in the partition path delimited by ",(0,n.kt)("inlineCode",{parentName:"p"},"/")," (3 in this case - month, year and day) it\ncauses ambiguity. In such cases, it is not possible to recover the partition value corresponding to each partition column."),(0,n.kt)("p",null,"There are two ways to ",(0,n.kt)("strong",{parentName:"p"},"avoid")," the breaking changes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The first option is to change how partition values are constructed. A user can switch the partition value of column\n",(0,n.kt)("inlineCode",{parentName:"p"},"month")," to avoid slashes in any partition column values, such as ",(0,n.kt)("inlineCode",{parentName:"p"},"202201"),", then there is no problem parsing the\npartition path (",(0,n.kt)("inlineCode",{parentName:"p"},"202201/03"),").  ")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The second option is to switch the listing mode to ",(0,n.kt)("inlineCode",{parentName:"p"},"eager"),'.  The File Index would "gracefully regress" to assume the\ntable is non-partitioned and just sacrifice partition-pruning, but would be able to process the query as if the\ntable was non-partitioned (therefore potentially incurring performance penalty), instead of failing the queries.'))),(0,n.kt)("h3",{id:"checkpoint-management-in-spark-structured-streaming"},"Checkpoint Management in Spark Structured Streaming"),(0,n.kt)("p",null,"If you are using ",(0,n.kt)("a",{parentName:"p",href:"https://spark.apache.org/docs/3.3.2/structured-streaming-programming-guide.html"},"Spark streaming")," to\ningest into Hudi, Hudi self-manages the checkpoint internally. We are now adding support for multiple writers, each\ningesting into the same Hudi table via streaming ingest. In older versions of hudi, you can't have multiple streaming\ningestion writers ingesting into the same hudi table (one streaming ingestion writer with a concurrent Spark datasource\nwriter works with lock provider; however, two Spark streaming ingestion writers are not supported). With 0.13.0, we are\nadding support where multiple streaming ingestions can be done to the same table. In case of a single streaming ingestion,\nusers don't have to do anything; the old pipeline will work without needing any additional changes. But, if you are\nhaving multiple streaming writers to same Hudi table, each table has to set a unique value for the config,\n",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.write.streaming.checkpoint.identifier"),". Also, users are expected to set the usual multi-writer\nconfigs. More details can be found ",(0,n.kt)("a",{parentName:"p",href:"/docs/concurrency_control"},"here"),"."),(0,n.kt)("h3",{id:"orc-support-in-spark"},"ORC Support in Spark"),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"https://orc.apache.org/"},"ORC")," support for Spark 2.x is removed in this release, as the dependency of\n",(0,n.kt)("inlineCode",{parentName:"p"},"orc-core:nohive")," in Hudi is now replaced by  ",(0,n.kt)("inlineCode",{parentName:"p"},"orc-core"),", to be compatible with Spark 3.  ",(0,n.kt)("a",{parentName:"p",href:"https://orc.apache.org/"},"ORC"),"\nsupport is now available for Spark 3.x, which was broken in previous releases."),(0,n.kt)("h3",{id:"mandatory-record-key-field"},"Mandatory Record Key Field"),(0,n.kt)("p",null,"The configuration for setting the record key field, ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.write.recordkey.field"),", is now required to be set\nand has no default value. Previously, the default value is ",(0,n.kt)("inlineCode",{parentName:"p"},"uuid"),"."),(0,n.kt)("h2",{id:"migration-guide-behavior-changes"},"Migration Guide: Behavior Changes"),(0,n.kt)("h3",{id:"schema-handling-in-write-path"},"Schema Handling in Write Path"),(0,n.kt)("p",null,"Many users have requested using Hudi for CDC use cases that they want to have schema auto-evolution where existing\ncolumns might be dropped in a new schema. As of 0.13.0 release, Hudi now has this functionality. You can permit schema\nauto-evolution where existing columns can be dropped in a new schema."),(0,n.kt)("p",null,"Since dropping columns in the target table based on the source schema constitutes a considerable behavior change, this\nis disabled by default and is guarded by the following config: ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.write.schema.allow.auto.evolution.column.drop"),".\nTo enable automatic dropping of the columns along with new evolved schema of the incoming batch, set this to ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"true")),"."),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"This config is ",(0,n.kt)("strong",{parentName:"p"},"NOT")," required to evolve schema manually by using, for example, ",(0,n.kt)("inlineCode",{parentName:"p"},"ALTER TABLE \u2026 DROP COLUMN")," in Spark."))),(0,n.kt)("h3",{id:"removal-of-default-shuffle-parallelism"},"Removal of Default Shuffle Parallelism"),(0,n.kt)("p",null,"This release changes how Hudi decides the shuffle parallelism of ",(0,n.kt)("a",{parentName:"p",href:"/docs/write_operations"},"write operations")," including\n",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"BULK_INSERT"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"UPSERT")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"DELETE")," (",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"hoodie.insert|bulkinsert|upsert|delete.shuffle.parallelism")),"), which\ncan ultimately affect the write performance."),(0,n.kt)("p",null,"Previously, if users did not configure it, Hudi would use ",(0,n.kt)("inlineCode",{parentName:"p"},"200")," as the default shuffle parallelism. From 0.13.0 onwards\nHudi by default automatically deduces the shuffle parallelism by either using the number of output RDD partitions as\ndetermined by Spark when available or by using the ",(0,n.kt)("inlineCode",{parentName:"p"},"spark.default.parallelism")," value.  If the above Hudi shuffle\nparallelisms are explicitly configured by the user, then the user-configured parallelism is still used in defining the\nactual parallelism.  Such behavior change improves the out-of-the-box performance by 20% for workloads with reasonably\nsized input."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"If the input data files are small, e.g., smaller than 10MB, we suggest configuring the Hudi shuffle parallelism\n(",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.insert|bulkinsert|upsert|delete.shuffle.parallelism"),") explicitly, such that the parallelism is at least\ntotal_input_data_size/500MB, to avoid potential performance regression (see ",(0,n.kt)("a",{parentName:"p",href:"/docs/tuning-guide"},"Tuning Guide")," for more\ninformation)."))),(0,n.kt)("h3",{id:"simple-write-executor-as-default"},"Simple Write Executor as Default"),(0,n.kt)("p",null,"For the execution of insert/upsert operations, Hudi historically used the notion of an executor, relying on in-memory\nqueue to decouple ingestion operations (that were previously often bound by I/O operations fetching shuffled blocks)\nfrom writing operations. Since then, Spark architectures have evolved considerably making such writing architecture\nredundant. Towards evolving this writing pattern and leveraging the changes in Spark, in 0.13.0 we introduce a new,\nsimplified version of the executor named (creatively) as ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"SimpleExecutor"))," and also make it out-of-the-box default."),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"SimpleExecutor"))," does not have any internal buffering (i.e., does not hold records in memory), which internally\nimplements simple iteration over provided iterator (similar to default Spark behavior).  It provides ",(0,n.kt)("strong",{parentName:"p"},"~10%"),"\nout-of-the-box performance improvement on modern Spark versions (3.x) and even more when used with Spark's native\n",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"SparkRecordMerger")),"."),(0,n.kt)("h3",{id:"none-sort-mode-for-bulk-insert-to-match-parquet-writes"},(0,n.kt)("inlineCode",{parentName:"h3"},"NONE")," Sort Mode for Bulk Insert to Match Parquet Writes"),(0,n.kt)("p",null,"This release adjusts the parallelism for ",(0,n.kt)("inlineCode",{parentName:"p"},"NONE")," sort mode (default sort mode) for ",(0,n.kt)("inlineCode",{parentName:"p"},"BULK_INSERT")," write operation. From\nnow on, by default, the input parallelism is used instead of the shuffle parallelism (",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.bulkinsert.shuffle.parallelism"),")\nfor writing data, to match the default parquet write behavior. This does not change the behavior of clustering using the\n",(0,n.kt)("inlineCode",{parentName:"p"},"NONE")," sort mode."),(0,n.kt)("p",null,"Such behavior change on ",(0,n.kt)("inlineCode",{parentName:"p"},"BULK_INSERT")," write operation improves the write performance out of the box."),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"If you still observe small file issues with the default ",(0,n.kt)("inlineCode",{parentName:"p"},"NONE")," sort mode, we suggest sorting the input data based on the\npartition path and record key before writing to the Hudi table. You can also use ",(0,n.kt)("inlineCode",{parentName:"p"},"GLOBAL_SORT")," to ensure the best file\nsize."))),(0,n.kt)("h3",{id:"meta-sync-failure-in-deltastreamer"},"Meta Sync Failure in Deltastreamer"),(0,n.kt)("p",null,"In earlier versions, we used a fail-fast approach where syncing to remaining catalogs is not attempted if any\n",(0,n.kt)("a",{parentName:"p",href:"/docs/syncing_metastore"},"catalog sync")," fails. In 0.13.0, syncing to all configured catalogs is attempted before failing\nthe operation on any catalog sync failure.  In the case of sync failure for one catalog, the sync to other catalogs can\nstill succeed, so the user only needs to retry the failed one now."),(0,n.kt)("h3",{id:"no-override-of-internal-metadata-table-configs"},"No Override of Internal Metadata Table Configs"),(0,n.kt)("p",null,"Since misconfiguration could lead to possible data integrity issues, in 0.13.0, we have put in efforts to make the\nmetadata table configuration much simpler for the users. Internally, Hudi determines the best choices for these\nconfigurations for optimal performance and stability of the system."),(0,n.kt)("p",null,"The following metadata-table-related configurations are made internal; you can no longer configure these configs\nexplicitly:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"hoodie.metadata.clean.async\nhoodie.metadata.cleaner.commits.retained\nhoodie.metadata.enable.full.scan.log.files\nhoodie.metadata.populate.meta.fields\n")),(0,n.kt)("h3",{id:"spark-sql-ctas-performance-fix"},"Spark SQL CTAS Performance Fix"),(0,n.kt)("p",null,"Previously, CTAS write operation was incorrectly set to use ",(0,n.kt)("inlineCode",{parentName:"p"},"UPSERT")," due to misconfiguration. In 0.13.0 release, we fix\nthis to make sure CTAS uses ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"BULK_INSERT"))," operation to boost the write performance of the first batch to a Hudi table\n(there's no real need to use ",(0,n.kt)("inlineCode",{parentName:"p"},"UPSERT")," for it, as the table is being created)."),(0,n.kt)("h3",{id:"flink-ckpmetadata"},"Flink CkpMetadata"),(0,n.kt)("p",null,"Before 0.13.0, we bootstrapped the ckp metadata (checkpoint related metadata) by cleaning all the messages. Some corner\ncases were not handled correctly. For example:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The write task can not fetch the pending instant correctly when restarting a job.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"If a checkpoint succeeds and the job crashes suddenly, the instant hasn't had time to commit. The data is lost because\nthe last pending instant was rolled back; however, the Flink engine still thinks the checkpoint/instant is successful."))),(0,n.kt)("p",null,"Q: Why did we clean the messages prior to the 0.13.0 release?"),(0,n.kt)("p",null,"A: To prevent inconsistencies between timeline and the messages."),(0,n.kt)("p",null,"Q: Why are we retaining the messages in the 0.13.0 release?"),(0,n.kt)("p",null,"A: There are two cases for the inconsistency:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"The timeline instant is complete but the ckp message is inflight (for committing instant).")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"The timeline instant is pending while the ckp message does not start (for starting a new instant)."))),(0,n.kt)("p",null,"For case 1, there is no need to re-commit the instant, and it is fine if the write task does not get any pending instant\nwhen recovering."),(0,n.kt)("p",null,"For case 2, the instant is basically pending. The instant would be rolled back (as expected). Thus, keeping the ckp\nmessages as is can actually maintain correctness."),(0,n.kt)("h2",{id:"release-highlights"},"Release Highlights"),(0,n.kt)("h3",{id:"metaserver"},"Metaserver"),(0,n.kt)("p",null,"In 0.13.0, we introduce Metaserver, a centralized metadata management service. This is one of the first platform service\ncomponents we introduce from many more to come. Metaserver helps users to easily manage a large number of tables in a\ndata lake platform."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"This is an ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"EXPERIMENTAL"))," feature."))),(0,n.kt)("p",null,"To set up the metaserver in your environment, use\n",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-metaserver-server-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-metaserver-server-bundle"))," and\nrun it as a java server application, like ",(0,n.kt)("inlineCode",{parentName:"p"},"java -jar hudi-metaserver-server-bundle-<HUDI_VERSION>.jar"),". On the client\nside, add the following options to integrate with the metaserver:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"hoodie.metaserver.enabled=true\nhoodie.metaserver.uris=thrift://<server url>:9090\n")),(0,n.kt)("p",null,"The Metaserver stores Hudi tables' metadata like table name, database, owner; and the timeline's metadata like commit\ninstants, actions, states, etc. In addition, the Metaserver supports the Spark writer and reader through Hudi Spark\nbundles."),(0,n.kt)("h3",{id:"change-data-capture"},"Change Data Capture"),(0,n.kt)("p",null,"In cases where Hudi tables are used as streaming sources, we want to be aware of all changes for the records that belong\nto a single commit.  For instance, we want to know which records were inserted, deleted and updated. For updated records,\nthe subsequent pipeline may want to get the old values before the update and the new ones after. Prior to 0.13.0, the\nincremental query does not contain the hard-delete records, and users need to use soft deletes to stream deletes, which\nmay not meet the GDPR requirements."),(0,n.kt)("p",null,"The Change-Data-Capture (CDC) feature enables Hudi to show how records are changed by producing the changes and\ntherefore to handle CDC query use cases."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"CDC is an ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"EXPERIMENTAL"))," feature and is supported to work for COW tables with Spark and Flink engines. MOR tables\nare not supported by CDC query yet."))),(0,n.kt)("p",null,"To use CDC, users need to enable it first while writing to a table to log extra data, which are returned by CDC\nincremental queries."),(0,n.kt)("p",null,"For writing, set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.table.cdc.enabled=true")," and specify CDC logging mode through ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.query.incremental.format"),",\nto control the data being logged. There are 3 modes to choose from:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"data_before_after")),": This logs the changed records' operations and the whole record before and after the change. This\nmode incurs the most CDC data on storage and has the least computing efforts for querying CDC results.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"data_before")),": This logs the changed records' operations and the whole record before the change.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"op_key_only")),": This only logs the changed records' operations and key. This mode incurs the least CDC data on\nstorage, and requires most computing efforts for querying CDC results."))),(0,n.kt)("p",null,"The default value is ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"data_before_after")),"."),(0,n.kt)("p",null,"For reading, set:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"hoodie.datasource.query.type=incremental\nhoodie.datasource.query.incremental.format=cdc\n")),(0,n.kt)("p",null,"and other usual ",(0,n.kt)("a",{parentName:"p",href:"/docs/quick-start-guide#incremental-query"},"incremental query"),"'s options like begin and end instant\ntimes, and CDC results are returned."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"Note that ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.table.cdc.enabled")," is a table configuration. Once it is enabled, it is not allowed to be turned off\nfor that table. Similarly, you cannot change ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.table.cdc.supplemental.logging.mode"),", once it's saved as a table\nconfiguration."))),(0,n.kt)("h3",{id:"optimizing-record-payload-handling"},"Optimizing Record Payload handling"),(0,n.kt)("p",null,"This release introduces the long-awaited support for handling records as their engine-native representations, therefore\navoiding the need to convert them to an intermediate one (Avro)."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"This feature is in an ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"EXPERIMENTAL"))," mode and is currently only supported for Spark."))),(0,n.kt)("p",null,"This was made possible through RFC-46 by introducing a new\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordMerger.java"},(0,n.kt)("inlineCode",{parentName:"a"},"HoodieRecordMerger")),"\nabstraction. The ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieRecordMerger")," is the core\nand a source of truth for implementing any merging semantics in Hudi going forward. In this capacity, it replaces the\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordPayload.java"},(0,n.kt)("inlineCode",{parentName:"a"},"HoodieRecordPayload")),"\nhierarchy previously used for implementing custom merging semantics. By relying on the unified\ncomponent in the form of a ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieRecordMerger")," allows us to handle records throughout the lifecycle of the write operation\nin a uniform manner. This substantially reduces latency because the records are now held in the engine-native\nrepresentation, avoiding unnecessary copying, deserialization and conversion to the intermediate representation (Avro).\nIn our benchmarks, upsert performance improves in the ballpark of 10% against 0.13.0 default state and 20% when compared\nto 0.12.2."),(0,n.kt)("p",null,"To try it today, you'd need to specify the configs differently for each Hudi table:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"For COW, specify ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.write.record.merger.impls=org.apache.hudi.HoodieSparkRecordMerger")),(0,n.kt)("li",{parentName:"ul"},"For MOR, specify ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.write.record.merger.impls=org.apache.hudi.HoodieSparkRecordMerger")," and\n",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.logfile.data.block.format=parquet"))),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"Please note, that the current\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/HoodieSparkRecordMerger.java"},(0,n.kt)("inlineCode",{parentName:"a"},"HoodieSparkRecordMerger")),"\nimplementation only supports merging semantic equivalent to the\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-common/src/main/java/org/apache/hudi/common/model/OverwriteWithLatestAvroPayload.java"},(0,n.kt)("inlineCode",{parentName:"a"},"OverwriteWithLatestAvroPayload")),"\nclass, which is the default ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieRecordPayload")," implementation used for merging records\ncurrently (set as \u201choodie.compaction.payload.class\u201d). Therefore, if you're using any other ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieRecordPayload"),"\nimplementation, unfortunately, you'd need to wait until it is replaced by the corresponding ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieRecordMerger")," implementation."))),(0,n.kt)("h3",{id:"new-source-support-in-deltastreamer"},"New Source Support in Deltastreamer"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/docs/hoodie_deltastreamer"},"Deltastreamer")," is a fully-managed incremental ETL utility that supports a wide variety of\nsources. In this release, we have added three new sources to its repertoire."),(0,n.kt)("h4",{id:"proto-kafka-source"},"Proto Kafka Source"),(0,n.kt)("p",null,"Deltastreamer already supports exactly-once ingestion of new events from Kafka using JSON and Avro formats.\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/ProtoKafkaSource.java"},(0,n.kt)("inlineCode",{parentName:"a"},"ProtoKafkaSource")),"\nextends this support to Protobuf class-based schemas as well. With just one additional config, one\ncan easily set up this source. Check out the ",(0,n.kt)("a",{parentName:"p",href:"/docs/hoodie_deltastreamer"},"docs")," for more details."),(0,n.kt)("h4",{id:"gcs-incremental-source"},"GCS Incremental Source"),(0,n.kt)("p",null,"Along the lines of ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/blog/2021/08/23/s3-events-source"},"S3 events source"),", we now have a reliable\nand fast way of ingesting from objects in Google Cloud Storage (GCS) through\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/GcsEventsHoodieIncrSource.java"},(0,n.kt)("inlineCode",{parentName:"a"},"GcsEventsHoodieIncrSource")),".\nCheck out the docs on how to set up this source."),(0,n.kt)("h4",{id:"pulsar-source"},"Pulsar Source"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://pulsar.apache.org/"},"Apache Pulsar")," is an open-source, distributed messaging and streaming platform built for\nthe cloud. ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/PulsarSource.java"},(0,n.kt)("inlineCode",{parentName:"a"},"PulsarSource")),"\nsupports ingesting from Apache Pulsar through the Deltastreamer. Check out the ",(0,n.kt)("a",{parentName:"p",href:"/docs/hoodie_deltastreamer"},"docs")," on how\nto set up this source."),(0,n.kt)("h3",{id:"support-for-partial-payload-update"},"Support for Partial Payload Update"),(0,n.kt)("p",null,"Partial update is a frequently asked use case from the community that requires the ability to update only certain fields\nand not replace the whole record. Previously, we recommended users satisfy this use case by bringing in their own custom\nrecord payload implementation.  With the popularity of this, in the 0.13.0 release, we added a new record payload\nimplementation,\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/release-0.13.0/hudi-common/src/main/java/org/apache/hudi/common/model/PartialUpdateAvroPayload.java"},(0,n.kt)("inlineCode",{parentName:"a"},"PartialUpdateAvroPayload")),",\nto support this out-of-the-box so users can use this implementation instead of having to write their own custom implementation."),(0,n.kt)("h3",{id:"consistent-hashing-index"},"Consistent Hashing Index"),(0,n.kt)("p",null,"We introduce the Consistent Hashing Index as yet another indexing option for your writes with Hudi. This is an\nenhancement to ",(0,n.kt)("a",{parentName:"p",href:"/releases/older-releases#bucket-index"},"Bucket Index")," which is added in the 0.11.0 release. With Bucket\nIndex, buckets/file groups per partition are statically allocated, whereas with Consistent Hashing Index, buckets can\ngrow dynamically and so users don't need to sweat about data skews. Buckets will expand and shrink depending on the load\nfactor for each partition. You can find the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/master/rfc/rfc-42/rfc-42.md"},"RFC")," for\nthe design of this feature."),(0,n.kt)("p",null,"Here are the configs of interest if you wish to give it a try."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"hoodie.index.type=bucket\nhoodie.index.bucket.engine=CONSISTENT_HASHING\nhoodie.bucket.index.max.num.buckets=128\nhoodie.bucket.index.min.num.buckets=32\nhoodie.bucket.index.num.buckets=4\n## do split if the bucket size reach 1.5 * max_file_size\nhoodie.bucket.index.split.threshold=1.5\n## do merge if the bucket size smaller than 0.2 * max_file_size\nhoodie.bucket.index.merge.threshold=0.1 \n")),(0,n.kt)("p",null,"To enforce shrinking or scaling up of buckets, you need to enable clustering using the following configs"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"## check resize for every 4 commit\nhoodie.clustering.inline=true\nhoodie.clustering.inline.max.commits=4\nhoodie.clustering.plan.strategy.class=org.apache.hudi.client.clustering.plan.strategy.SparkConsistentBucketClusteringPlanStrategy\nhoodie.clustering.execution.strategy.class=org.apache.hudi.client.clustering.run.strategy.SparkConsistentBucketClusteringExecutionStrategy\n## for supporting concurrent write & resizing\nhoodie.clustering.updates.strategy=org.apache.hudi.client.clustering.update.strategy.SparkConsistentBucketDuplicateUpdateStrategy\n")),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"Consistent Hashing Index is still an evolving feature and currently there are some limitations to use it as of 0.13.0:"),(0,n.kt)("ul",{parentName:"div"},(0,n.kt)("li",{parentName:"ul"},"This index is supported only for Spark engine using a MOR table."),(0,n.kt)("li",{parentName:"ul"},"It does not work with metadata table enabled."),(0,n.kt)("li",{parentName:"ul"},"To scale up or shrink the buckets, users have to manually trigger clustering using above configs (at some cadence), but\nthey cannot have compaction concurrently running."),(0,n.kt)("li",{parentName:"ul"},"So, if compaction is enabled with your regular write pipeline, please follow this recommendation: You can choose to\ntrigger the scale/shrink once every 12 hours. In such cases, once every 12 hours, you might need to disable compaction,\nstop your write pipeline and enable clustering. You should take extreme care to not run both concurrently because it\nmight result in conflicts and a failed pipeline. Once clustering is complete, you can resume your regular write pipeline,\nwhich will have compaction enabled.")))),(0,n.kt)("p",null,"We are working towards automating these and making it easier for users to leverage the Consistent Hashing Index. You can\nfollow the ongoing work on the Consistent Hashing Index ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-3000"},"here"),"."),(0,n.kt)("h3",{id:"early-conflict-detection-for-multi-writer"},"Early Conflict Detection for Multi-Writer"),(0,n.kt)("p",null,"Hudi provides Optimistic Concurrency Control (OCC) to allow multiple writers to concurrently write and atomically commit\nto the Hudi table if there is no overlapping data file to be written, to guarantee data consistency, integrity and\ncorrectness. Prior to the 0.13.0 release, such conflict detection of overlapping data files is performed before commit\nmetadata and after the data writing is completed. If any conflict is detected in the final stage, it could have wasted\ncompute resources because the data writing is finished already."),(0,n.kt)("p",null,"To improve the concurrency control, the 0.13.0 release introduces a new feature, early conflict detection in OCC, to\ndetect the conflict during the data writing phase and abort the writing early on once a conflict is detected, using\nHudi's marker mechanism.  Hudi can now stop a conflicting writer much earlier because of the early conflict detection\nand release computing resources necessary to cluster, improving resource utilization."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"The early conflict detection in OCC is ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"EXPERIMENTAL"))," in 0.13.0 release."))),(0,n.kt)("p",null,"By default, this feature is turned off. To try this out, a user needs to set\n",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.write.concurrency.early.conflict.detection.enable")," to ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("inlineCode",{parentName:"strong"},"true")),", when using OCC for concurrency control\n(see the ",(0,n.kt)("a",{parentName:"p",href:"/docs/concurrency_control"},"Concurrency Control")," page for more details)."),(0,n.kt)("h3",{id:"lock-free-message-queue-in-writing-data"},"Lock-Free Message Queue in Writing Data"),(0,n.kt)("p",null,"In previous versions, Hudi writes incoming data into a table via a bounded in-memory queue using a producer-consumer\nmodel. In this release, we added a new type of queue, leveraging ",(0,n.kt)("a",{parentName:"p",href:"https://lmax-exchange.github.io/disruptor/user-guide/index.html"},"Disruptor"),",\nwhich is lock-free. This increases the write throughput when data volume is large.\n",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/5416"},"The benchmark")," writing 100 million records to 1000 partitions in a Hudi table\non cloud storage shows ",(0,n.kt)("strong",{parentName:"p"},"20%")," performance improvement compared to the existing executor type of bounded in-memory queue."),(0,n.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},(0,n.kt)("inlineCode",{parentName:"p"},"DisruptorExecutor")," is supported for Spark insert and Spark bulk insert operations as an ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"EXPERIMENTAL"))," feature"))),(0,n.kt)("p",null,"Users can set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.write.executor.type=DISRUPTOR_EXECUTOR")," to enable this feature. There are other configurations\nlike ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.write.wait.strategy")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.write.buffer.size")," to tune the performance further."),(0,n.kt)("h3",{id:"hudi-cli-bundle"},"Hudi CLI Bundle"),(0,n.kt)("p",null,"We introduce a new Hudi CLI Bundle, ",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-cli-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-cli-bundle_2.12")),",\nfor Spark 3.x to make Hudi CLI easier and more usable.  A user can now use this single bundle jar\n(published to Maven repository) along with Hudi Spark bundle to start the script\nto launch the Hudi-CLI shell with Spark. This brings ease of deployment for the Hudi-CLI as the user does not need to\ncompile the Hudi CLI module locally, upload jars and address any dependency conflict if there is any, which was the\ncase before this release. Detailed instructions can be found on the ",(0,n.kt)("a",{parentName:"p",href:"/docs/cli"},"Hudi CLI")," page."),(0,n.kt)("h3",{id:"support-for-flink-116"},"Support for Flink 1.16"),(0,n.kt)("p",null,"Flink 1.16.x is integrated with Hudi, using profile param ",(0,n.kt)("inlineCode",{parentName:"p"},"-Pflink1.16")," when compiling the source code to activate the\nversion. Alternatively, use ",(0,n.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/org.apache.hudi/hudi-flink1.16-bundle"},(0,n.kt)("inlineCode",{parentName:"a"},"hudi-flink1.16-bundle")),".\nFlink 1.15, Flink 1.14 and Flink 1.13 will continue to be supported. Please check the ",(0,n.kt)("a",{parentName:"p",href:"#new-flink-bundle"},"migration guide"),"\nfor bundle updates."),(0,n.kt)("h3",{id:"json-schema-converter"},"Json Schema Converter"),(0,n.kt)("p",null,"For DeltaStreamer users who configure schema registry, a JSON schema converter is added to help convert JSON schema into\nAVRO for the target Hudi table. Set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.deltastreamer.schemaprovider.registry.schemaconverter")," to\n",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.utilities.schema.converter.JsonToAvroSchemaConverter")," to use this feature. Users can also implement\nthis interface ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.utilities.schema.SchemaRegistryProvider.SchemaConverter")," to provide custom conversion\nfrom the original schema to AVRO."),(0,n.kt)("h3",{id:"providing-hudi-configs-via-spark-sql-config"},"Providing Hudi Configs via Spark SQL Config"),(0,n.kt)("p",null,"Users can now provide Hudi configs via Spark SQL conf, for example, setting"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'spark.sql("set hoodie.sql.bulk.insert.enable = true")\n')),(0,n.kt)("p",null,"to make sure Hudi is able to use ",(0,n.kt)("inlineCode",{parentName:"p"},"BULK_INSERT")," operation when executing ",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT INTO")," statement."),(0,n.kt)("h2",{id:"known-regressions"},"Known Regressions"),(0,n.kt)("p",null,"We discovered a regression in Hudi 0.13 release related to metadata table and timeline server interplay with streaming ingestion pipelines. "),(0,n.kt)("p",null,"The FileSystemView that Hudi maintains internally could go out of sync due to a occasional race conditions when table services are involved\n(compaction, clustering) and could result in updates and deletes routed to older file versions and hence resulting in missed updates and deletes.   "),(0,n.kt)("p",null,"Here are the user-flows that could potentially be impacted with this."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"This impacts pipelines using Deltastreamer in ",(0,n.kt)("strong",{parentName:"li"},"continuous mode")," (sync once is not impacted), Spark streaming, or if you have been directly\nusing write client across batches/commits instead of the standard ways to write to Hudi. In other words, batch writes should not be impacted."),(0,n.kt)("li",{parentName:"ul"},"Among these write models, this could have an impact only when table services are enabled. ",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"COW: clustering enabled (inline or async)"),(0,n.kt)("li",{parentName:"ul"},"MOR: compaction enabled (by default, inline or async)"))),(0,n.kt)("li",{parentName:"ul"},"Also, the impact is applicable only when metadata table is enabled, and timeline server is enabled (which are defaults as of 0.13.0)")),(0,n.kt)("p",null,"Based on some production data, we expect this issue might impact roughly < 1% of updates to be missed, since its a race condition\nand table services are generally scheduled once every N commits. The percentage of update misses could be even less if the\nfrequency of table services is less."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-5863"},"Here")," is the jira for the issue of interest and the fix has already been landed in master.\nNext minor release(0.13.1) should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8079"},"fix"),". Until we have a next minor release with the fix, we recommend you to disable metadata table\n(",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=false"),") to mitigate the issue."),(0,n.kt)("p",null,"We also discovered a regression for Flink streaming writer with the hive meta sync which is introduced by HUDI-3730, the refactoring to ",(0,n.kt)("inlineCode",{parentName:"p"},"HiveSyncConfig"),"\ncauses the Hive ",(0,n.kt)("inlineCode",{parentName:"p"},"Resources")," config objects leaking, which finally leads to an OOM exception for the JobManager if the streaming job runs continuously for weeks.\nNext minor release(0.13.1) should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8050"},"fix"),". Until we have a 0.13.1 release, we recommend you to cherry-pick the fix to local\nif hive meta sync is required."),(0,n.kt)("p",null,"Sorry about the inconvenience caused."),(0,n.kt)("h2",{id:"raw-release-notes"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12352101"},"here"),"."),(0,n.kt)("h2",{id:"release-0121-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.12.1"},"Release 0.12.1")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.12.1/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"long-term-support"},"Long Term Support"),(0,n.kt)("p",null,"We aim to maintain 0.12 for a longer period of time and provide a stable release through the latest 0.12.x release for\nusers to migrate to.  The latest 0.12 release is ",(0,n.kt)("a",{parentName:"p",href:"/releases/release-0.12.2"},"0.12.2"),"."),(0,n.kt)("h2",{id:"migration-guide"},"Migration Guide"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"This release (0.12.1) does not introduce any new table version, thus no migration is needed if you are on 0.12.0."),(0,n.kt)("li",{parentName:"ul"},"If migrating from an older release, please check the migration guide from the previous release notes, specifically\nthe upgrade instructions in ",(0,n.kt)("a",{parentName:"li",href:"/releases/older-releases#release-060-docs"},"0.6.0"),",\n",(0,n.kt)("a",{parentName:"li",href:"/releases/older-releases#release-090-docs"},"0.9.0"),", ",(0,n.kt)("a",{parentName:"li",href:"/releases/older-releases#release-0100-docs"},"0.10.0"),",\n",(0,n.kt)("a",{parentName:"li",href:"/releases/older-releases#release-0110-docs"},"0.11.0"),", and ",(0,n.kt)("a",{parentName:"li",href:"/releases/older-releases#release-0120-docs"},"0.12.0"),".")),(0,n.kt)("h2",{id:"release-highlights-1"},"Release Highlights"),(0,n.kt)("h3",{id:"improve-hudi-cli"},"Improve Hudi Cli"),(0,n.kt)("p",null,"Add command to repair deprecated partition, rename partition and trace file group through a range of commits."),(0,n.kt)("h3",{id:"fix-invalid-record-key-stats-in-parquet-metadata"},"Fix invalid record key stats in Parquet metadata"),(0,n.kt)("p",null,'Crux of the problem was that min/max statistics for the record keys were computed incorrectly during (Spark-specific) row-writing\nBulk Insert operation affecting Key Range Pruning flow w/in Hoodie Bloom Index tagging sequence, resulting into updated records being incorrectly tagged\nas "inserts" and not as "updates", leading to duplicated records in the table.'),(0,n.kt)("p",null,"If all of the following is applicable to you:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Using Spark as an execution engine"),(0,n.kt)("li",{parentName:"ol"},"Using Bulk Insert (using row-writing\n",(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/next/configurations#hoodiedatasourcewriterowwriterenable"},"https://hudi.apache.org/docs/next/configurations#hoodiedatasourcewriterowwriterenable"),",\nenabled ",(0,n.kt)("em",{parentName:"li"},"by default"),")"),(0,n.kt)("li",{parentName:"ol"},"Using Bloom Index (with range-pruning\n",(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/next/basic_configurations/#hoodiebloomindexprunebyranges"},"https://hudi.apache.org/docs/next/basic_configurations/#hoodiebloomindexprunebyranges"),"\nenabled, enabled ",(0,n.kt)("em",{parentName:"li"},"by default"),') for "UPSERT" operations')),(0,n.kt)("p",null,"Recommended to upgrading to 0.12.1 to avoid getting duplicate records in your pipeline."),(0,n.kt)("h3",{id:"bug-fixes"},"Bug fixes"),(0,n.kt)("p",null,"0.12.1 release is mainly intended for bug fixes and stability. The fixes span across many components, including"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"DeltaStreamer"),(0,n.kt)("li",{parentName:"ul"},"Table config"),(0,n.kt)("li",{parentName:"ul"},"Table services"),(0,n.kt)("li",{parentName:"ul"},"Metadata table"),(0,n.kt)("li",{parentName:"ul"},"Spark SQL support"),(0,n.kt)("li",{parentName:"ul"},"Presto support"),(0,n.kt)("li",{parentName:"ul"},"Hive Sync"),(0,n.kt)("li",{parentName:"ul"},"Flink engine"),(0,n.kt)("li",{parentName:"ul"},"Unit, functional, integration tests and CI")),(0,n.kt)("h2",{id:"known-regressions-1"},"Known Regressions"),(0,n.kt)("p",null,"We discovered a regression in Hudi 0.12.1 release related to metadata table and timeline server interplay with streaming ingestion pipelines."),(0,n.kt)("p",null,"The FileSystemView that Hudi maintains internally could go out of sync due to a occasional race conditions when table services are involved\n(compaction, clustering) and could result in updates and deletes routed to older file versions and hence resulting in missed updates and deletes."),(0,n.kt)("p",null,"Here are the user-flows that could potentially be impacted with this."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"This impacts pipelines using Deltastreamer in ",(0,n.kt)("strong",{parentName:"li"},"continuous mode")," (sync once is not impacted), Spark streaming, or if you have been directly\nusing write client across batches/commits instead of the standard ways to write to Hudi. In other words, batch writes should not be impacted."),(0,n.kt)("li",{parentName:"ul"},"Among these write models, this could have an impact only when table services are enabled.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"COW: clustering enabled (inline or async)"),(0,n.kt)("li",{parentName:"ul"},"MOR: compaction enabled (by default, inline or async)"))),(0,n.kt)("li",{parentName:"ul"},"Also, the impact is applicable only when metadata table is enabled, and timeline server is enabled (which are defaults as of 0.12.1)")),(0,n.kt)("p",null,"Based on some production data, we expect this issue might impact roughly < 1% of updates to be missed, since its a race condition\nand table services are generally scheduled once every N commits. The percentage of update misses could be even less if the\nfrequency of table services is less."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-5863"},"Here")," is the jira for the issue of interest and the fix has already been landed in master.\n0.12.3 should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8079"},"fix"),". Until we have a 0.12.3 release, we recommend you to disable metadata table\n(",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=false"),") to mitigate the issue."),(0,n.kt)("p",null,"We also discovered a regression for Flink streaming writer with the hive meta sync which is introduced by HUDI-3730, the refactoring to ",(0,n.kt)("inlineCode",{parentName:"p"},"HiveSyncConfig"),"\ncauses the Hive ",(0,n.kt)("inlineCode",{parentName:"p"},"Resources")," config objects leaking, which finally leads to an OOM exception for the JobManager if the streaming job runs continuously for weeks.\n0.12.3 should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8050"},"fix"),". Until we have a 0.12.3 release, we recommend you to cherry-pick the fix to local\nif hive meta sync is required."),(0,n.kt)("p",null,"Sorry about the inconvenience caused."),(0,n.kt)("h2",{id:"raw-release-notes-1"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12352182"},"here")),(0,n.kt)("h2",{id:"release-0120-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.12.0"},"Release 0.12.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.12.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"long-term-support-1"},"Long Term Support"),(0,n.kt)("p",null,"We aim to maintain 0.12 for a longer period of time and provide a stable release through the latest 0.12.x release for\nusers to migrate to.  The latest 0.12 release is ",(0,n.kt)("a",{parentName:"p",href:"/releases/release-0.12.2"},"0.12.2"),"."),(0,n.kt)("h2",{id:"migration-guide-1"},"Migration Guide"),(0,n.kt)("p",null,"In this release, there have been a few API and configuration updates listed below that warranted a new table version.\nHence, the latest ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf86efef719b7760ea379bfa08c537431eeee09a/hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableVersion.java#L41"},"table version"),"\nis ",(0,n.kt)("inlineCode",{parentName:"p"},"5"),". For existing Hudi tables on older version, a one-time upgrade step will be executed automatically. Please take\nnote of the following updates before upgrading to Hudi 0.12.0."),(0,n.kt)("h3",{id:"configuration-updates"},"Configuration Updates"),(0,n.kt)("p",null,"In this release, the default value for a few configurations have been changed. They are as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.bulkinsert.sort.mode"),": This config is used to determine mode for sorting records for bulk insert. Its default value has been changed from ",(0,n.kt)("inlineCode",{parentName:"p"},"GLOBAL_SORT")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"NONE"),", which means no sorting is done and it matches ",(0,n.kt)("inlineCode",{parentName:"p"},"spark.write.parquet()")," in terms of overhead.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.hive_sync.partition_value_extractor"),": This config is used to extract and transform partition value during Hive sync. Its default value has been changed from ",(0,n.kt)("inlineCode",{parentName:"p"},"SlashEncodedDayPartitionValueExtractor")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"MultiPartKeysValueExtractor"),". If you relied on the previous default value (i.e., have not set it explicitly), you are required to set the config to ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.hive.SlashEncodedDayPartitionValueExtractor"),". From this release, if this config is not set and Hive sync is enabled, then partition value extractor class will be ",(0,n.kt)("strong",{parentName:"p"},"automatically inferred")," on the basis of number of partition fields and whether or not hive style partitioning is enabled.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The following configs will be inferred, if not set manually, from other configs' values:"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"META_SYNC_BASE_FILE_FORMAT"),": infer from ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.common.table.HoodieTableConfig.BASE_FILE_FORMAT"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"META_SYNC_ASSUME_DATE_PARTITION"),": infer from ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.common.config.HoodieMetadataConfig.ASSUME_DATE_PARTITIONING"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"META_SYNC_DECODE_PARTITION"),": infer from ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.common.table.HoodieTableConfig.URL_ENCODE_PARTITIONING"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("inlineCode",{parentName:"p"},"META_SYNC_USE_FILE_LISTING_FROM_METADATA"),": infer from ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.common.config.HoodieMetadataConfig.ENABLE")))))),(0,n.kt)("h3",{id:"api-updates"},"API Updates"),(0,n.kt)("p",null,"In ",(0,n.kt)("inlineCode",{parentName:"p"},"SparkKeyGeneratorInterface"),", return type of the ",(0,n.kt)("inlineCode",{parentName:"p"},"getRecordKey")," API has been changed from String to UTF8String."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"// Before\nString getRecordKey(InternalRow row, StructType schema); \n\n\n// After\nUTF8String getRecordKey(InternalRow row, StructType schema); \n")),(0,n.kt)("h3",{id:"fallback-partition"},"Fallback Partition"),(0,n.kt)("p",null,"If partition field value was null, Hudi has a fallback mechanism instead of failing the write. Until 0.9.0,\n",(0,n.kt)("inlineCode",{parentName:"p"},"__HIVE_DEFAULT_PARTITION__"),"  was used as the fallback partition. After 0.9.0, due to some refactoring, fallback\npartition changed to ",(0,n.kt)("inlineCode",{parentName:"p"},"default"),". This default partition does not sit well with some of the query engines. So, we are\nswitching the fallback partition to ",(0,n.kt)("inlineCode",{parentName:"p"},"__HIVE_DEFAULT_PARTITION__"),"  from 0.12.0. We have added an upgrade step where in,\nwe fail the upgrade if the existing Hudi table has a partition named ",(0,n.kt)("inlineCode",{parentName:"p"},"default"),". Users are expected to rewrite the data\nin this partition to a partition named ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/0d0a4152cfd362185066519ae926ac4513c7a152/hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java#L29"},"_","_","HIVE_DEFAULT_PARTITION","_","_"),".\nHowever, if you had intentionally named your partition as ",(0,n.kt)("inlineCode",{parentName:"p"},"default"),", you can bypass this using the config ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.skip.default.partition.validation"),"."),(0,n.kt)("h3",{id:"bundle-updates-1"},"Bundle Updates"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"hudi-aws-bundle")," extracts away aws-related dependencies from hudi-utilities-bundle or hudi-spark-bundle. In order to use features such as Glue sync, Cloudwatch metrics reporter or DynamoDB lock provider, users need to provide hudi-aws-bundle jar along with hudi-utilities-bundle or hudi-spark-bundle jars."),(0,n.kt)("li",{parentName:"ul"},"Spark 3.3 support is added; users who are on Spark 3.3 can use ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3.3-bundle")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3-bundle")," (legacy bundle name)."),(0,n.kt)("li",{parentName:"ul"},"Spark 3.2 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3.2-bundle"),"."),(0,n.kt)("li",{parentName:"ul"},"Spark 3.1 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3.1-bundle"),"."),(0,n.kt)("li",{parentName:"ul"},"Spark 2.4 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark2.4-bundle")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark-bundle")," (legacy bundle name)."),(0,n.kt)("li",{parentName:"ul"},"Flink 1.15 support is added; users who are on Flink 1.15 can use ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-flink1.15-bundle"),"."),(0,n.kt)("li",{parentName:"ul"},"Flink 1.14 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-flink1.14-bundle"),"."),(0,n.kt)("li",{parentName:"ul"},"Flink 1.13 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-flink1.13-bundle"),".")),(0,n.kt)("h2",{id:"release-highlights-2"},"Release Highlights"),(0,n.kt)("h3",{id:"presto-hudi-connector"},"Presto-Hudi Connector"),(0,n.kt)("p",null,"Since version 0.275 of PrestoDB, users can now leverage native Hudi connector to query Hudi table.\nIt is on par with Hudi support in the Hive connector. To learn more about the usage of the connector,\nplease checkout ",(0,n.kt)("a",{parentName:"p",href:"https://prestodb.io/docs/current/connector/hudi.html"},"prestodb documentation"),"."),(0,n.kt)("h3",{id:"archival-beyond-savepoint"},"Archival Beyond Savepoint"),(0,n.kt)("p",null,"Hudi supports savepoint and restore feature that is useful for backup and disaster recovery scenarios. More info can be\nfound ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/disaster_recovery"},"here"),". Until 0.12.0, archival for a given table will not make\nprogress beyond the first savepointed commit. But there has been ask from the community to relax this constraint so that\nsome coarse grained commits can be retained in the active timeline and execute point in time queries. So, with 0.12.0,\nusers can now let archival proceed beyond savepoint commits by enabling ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.archive.beyond.savepoint"),' write\nconfiguration. This unlocks new opportunities for Hudi users. For example, one can retain commits for years, by adding\none savepoint per day for older commits (lets say > 30 days). And query hudi table using "as.of.instant" with any older\nsavepointed commit. By this, Hudi does not need to retain every commit in the active timeline for older commits.'),(0,n.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"However, if this feature is enabled, restore cannot be supported. This limitation would be relaxed in a future release\nand the development of this feature can be tracked in ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-4500"},"HUDI-4500"),"."))),(0,n.kt)("h3",{id:"file-system-based-lock-provider"},"File system based Lock Provider"),(0,n.kt)("p",null,"For multiple writers using optimistic concurrency control, Hudi already supports lock providers based on\nZookeeper, Hive Metastore or Amazon DynamoDB. In this release, there is a new file system based lock provider. Unlike the\nneed for external systems in other lock providers, this implementation acquires/releases a lock based on atomic\ncreate/delete operations of the underlying file system. To use this lock provider, users need to set the following\nminimal configurations (please check the ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#Locks-Configurations"},"lock configuration")," for a few\nother optional configs that can be used):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"hoodie.write.concurrency.mode=optimistic_concurrency_control\nhoodie.write.lock.provider=org.apache.hudi.client.transaction.lock.FileSystemBasedLockProvider\n")),(0,n.kt)("h3",{id:"deltastreamer-termination-strategy"},"Deltastreamer Termination Strategy"),(0,n.kt)("p",null,"Users can now configure a post-write termination strategy with deltastreamer ",(0,n.kt)("inlineCode",{parentName:"p"},"continuous")," mode if need be. For instance,\nusers can configure graceful shutdown if there is no new data from source for 5 consecutive times. Here is the interface\nfor the termination strategy."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"/**\n * Post write termination strategy for deltastreamer in continuous mode.\n */\npublic interface PostWriteTerminationStrategy {\n\n  /**\n   * Returns whether deltastreamer needs to be shutdown.\n   * @param scheduledCompactionInstantAndWriteStatuses optional pair of scheduled compaction instant and write statuses.\n   * @return true if deltastreamer has to be shutdown. false otherwise.\n   */\n  boolean shouldShutdown(Option<Pair<Option<String>, JavaRDD<WriteStatus>>> scheduledCompactionInstantAndWriteStatuses);\n\n}\n")),(0,n.kt)("p",null,"Also, this might help in bootstrapping a new table. Instead of doing one bulk load or bulk_insert leveraging a large\ncluster for a large input of data, one could start deltastreamer on continuous mode and add a shutdown strategy to\nterminate, once all data has been bootstrapped. This way, each batch could be smaller and may not need a large cluster\nto bootstrap data. We have one concrete implementation out of the box, ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/0d0a4152cfd362185066519ae926ac4513c7a152/hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/NoNewDataTerminationStrategy.java"},"NoNewDataTerminationStrategy"),".\nUsers can feel free to implement their own strategy as they see fit."),(0,n.kt)("h3",{id:"spark-33-support"},"Spark 3.3 Support"),(0,n.kt)("p",null,"Spark 3.3 support is added; users who are on Spark 3.3 can use ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-spark3.3-bundle")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-spark3-bundle"),". Spark 3.2,\nSpark 3.1 and Spark 2.4 will continue to be supported. Please check the migration guide for ",(0,n.kt)("a",{parentName:"p",href:"#bundle-updates"},"bundle updates"),"."),(0,n.kt)("h3",{id:"spark-sql-support-improvements"},"Spark SQL Support Improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Support for upgrade, downgrade, bootstrap, clean, rollback and repair through ",(0,n.kt)("inlineCode",{parentName:"li"},"Call Procedure")," command."),(0,n.kt)("li",{parentName:"ul"},"Support for ",(0,n.kt)("inlineCode",{parentName:"li"},"analyze table"),"."),(0,n.kt)("li",{parentName:"ul"},"Support for ",(0,n.kt)("inlineCode",{parentName:"li"},"Create/Drop/Show/Refresh Index")," syntax through Spark SQL.")),(0,n.kt)("h3",{id:"flink-115-support"},"Flink 1.15 Support"),(0,n.kt)("p",null,"Flink 1.15.x is integrated with Hudi, use profile param ",(0,n.kt)("inlineCode",{parentName:"p"},"-Pflink1.15")," when compiling the codes to adapt the version.\nAlternatively, use ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-flink1.15-bundle"),". Flink 1.14 and Flink 1.13 will continue to be supported. Please check the\nmigration guide for ",(0,n.kt)("a",{parentName:"p",href:"#bundle-updates"},"bundle updates"),"."),(0,n.kt)("h3",{id:"flink-integration-improvements"},"Flink Integration Improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Data skipping")," is supported for batch mode read, set up SQL option ",(0,n.kt)("inlineCode",{parentName:"li"},"metadata.enabled"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.metadata.index.column.stats.enable"),"  and ",(0,n.kt)("inlineCode",{parentName:"li"},"read.data.skipping.enabled")," as true to enable it."),(0,n.kt)("li",{parentName:"ul"},"A ",(0,n.kt)("strong",{parentName:"li"},"HMS-based Flink catalog")," is added with catalog identifier as ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi"),". You can instantiate the catalog through API directly or use the ",(0,n.kt)("inlineCode",{parentName:"li"},"CREATE CATALOG"),"  syntax to create it. Specifies catalog option ",(0,n.kt)("inlineCode",{parentName:"li"},"'mode' = 'hms'"),"  to switch to the HMS catalog. By default, the catalog is in ",(0,n.kt)("inlineCode",{parentName:"li"},"dfs")," mode."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Async clustering")," is supported for Flink ",(0,n.kt)("inlineCode",{parentName:"li"},"INSERT")," operation, set up SQL option ",(0,n.kt)("inlineCode",{parentName:"li"},"clustering.schedule.enabled")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"clustering.async.enabled")," as true to enable it. When enabling this feature, a clustering sub-pipeline is scheduled asynchronously continuously to merge the small files continuously into larger ones.")),(0,n.kt)("h3",{id:"performance-improvements"},"Performance Improvements"),(0,n.kt)("p",null,"This version brings more improvements to make Hudi the most performant lake storage format. Some notable improvements are:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Closed the performance gap in writing through Spark datasource vs sql. Previously, datasource writes were faster."),(0,n.kt)("li",{parentName:"ul"},"All built-in key generators implement more performant Spark-specific APIs."),(0,n.kt)("li",{parentName:"ul"},"Replaced UDF in bulk insert operation with RDD transformation to cut down serde cost."),(0,n.kt)("li",{parentName:"ul"},"Optimized column stats index performance in data skipping.")),(0,n.kt)("p",null,"We recently benchmarked Hudi against TPC-DS workload.\nPlease check out ",(0,n.kt)("a",{parentName:"p",href:"/blog/2022/06/29/Apache-Hudi-vs-Delta-Lake-transparent-tpc-ds-lakehouse-performance-benchmarks"},"our blog")," for more details."),(0,n.kt)("h2",{id:"known-regressions-2"},"Known Regressions:"),(0,n.kt)("p",null,"We discovered a regression in Hudi 0.12 release related to Bloom\nIndex metadata persisted w/in Parquet footers ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-4992"},"HUDI-4992"),"."),(0,n.kt)("p",null,"Crux of the problem was that min/max statistics for the record keys were\ncomputed incorrectly during (Spark-specific) ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodiedatasourcewriterowwriterenable"},"row-writing"),"\nBulk Insert operation affecting ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/basic_configurations/#hoodiebloomindexprunebyranges"},"Key Range Pruning flow"),"\nw/in ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/faq/#how-do-i-configure-bloom-filter-when-bloomglobal_bloom-index-is-used"},"Hoodie Bloom Index"),'\ntagging sequence, resulting into updated records being incorrectly tagged\nas "inserts" and not as "updates", leading to duplicated records in the\ntable.'),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/6883"},"PR#6883")," addressing the problem is incorporated into\nHudi 0.12.1 release.*"),(0,n.kt)("p",null,"If all of the following is applicable to you:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Using Spark as an execution engine"),(0,n.kt)("li",{parentName:"ol"},"Using Bulk Insert (using ",(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/next/configurations#hoodiedatasourcewriterowwriterenable"},"row-writing"),",\nenabled ",(0,n.kt)("em",{parentName:"li"},"by default"),")"),(0,n.kt)("li",{parentName:"ol"},"Using Bloom Index (with ",(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/next/basic_configurations/#hoodiebloomindexprunebyranges"},"range-pruning"),"\nenabled, enabled ",(0,n.kt)("em",{parentName:"li"},"by default"),') for "UPSERT" operations')),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Note: Default index type is SIMPLE. So, unless you have over-ridden the index type, you may not hit this issue.")),(0,n.kt)("p",null,"Please consider one of the following potential remediations to avoid\ngetting duplicate records in your pipeline:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/next/basic_configurations/#hoodiebloomindexprunebyranges"},"Disabling Bloom Index range-pruning"),"\nflow (might\naffect performance of upsert operations)"),(0,n.kt)("li",{parentName:"ul"},"Upgrading to 0.12.1."),(0,n.kt)("li",{parentName:"ul"},"Making sure that the ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/6883"},"fix")," is\nincluded in your custom artifacts (if you're building and using ones)")),(0,n.kt)("p",null,"We also found another regression related to metadata table and timeline server interplay with streaming ingestion pipelines."),(0,n.kt)("p",null,"The FileSystemView that Hudi maintains internally could go out of sync due to a occasional race conditions when table services are involved\n(compaction, clustering) and could result in updates and deletes routed to older file versions and hence resulting in missed updates and deletes."),(0,n.kt)("p",null,"Here are the user-flows that could potentially be impacted with this."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"This impacts pipelines using Deltastreamer in ",(0,n.kt)("strong",{parentName:"li"},"continuous mode")," (sync once is not impacted), Spark streaming, or if you have been directly\nusing write client across batches/commits instead of the standard ways to write to Hudi. In other words, batch writes should not be impacted."),(0,n.kt)("li",{parentName:"ul"},"Among these write models, this could have an impact only when table services are enabled.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"COW: clustering enabled (inline or async)"),(0,n.kt)("li",{parentName:"ul"},"MOR: compaction enabled (by default, inline or async)"))),(0,n.kt)("li",{parentName:"ul"},"Also, the impact is applicable only when metadata table is enabled, and timeline server is enabled (which are defaults as of 0.12.0)")),(0,n.kt)("p",null,"Based on some production data, we expect this issue might impact roughly < 1% of updates to be missed, since its a race condition\nand table services are generally scheduled once every N commits. The percentage of update misses could be even less if the\nfrequency of table services is less."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-5863"},"Here")," is the jira for the issue of interest and the fix has already been landed in master.\n0.12.3 should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8079"},"fix"),". Until we have a 0.12.3 release, we recommend you to disable metadata table\n(",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=false"),") to mitigate the issue."),(0,n.kt)("p",null,"We also discovered a regression for Flink streaming writer with the hive meta sync which is introduced by HUDI-3730, the refactoring to ",(0,n.kt)("inlineCode",{parentName:"p"},"HiveSyncConfig"),"\ncauses the Hive ",(0,n.kt)("inlineCode",{parentName:"p"},"Resources")," config objects leaking, which finally leads to an OOM exception for the JobManager if the streaming job runs continuously for weeks.\n0.12.3 should have the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/8050"},"fix"),". Until we have a 0.12.3 release, we recommend you to cherry-pick the fix to local\nif hive meta sync is required."),(0,n.kt)("p",null,"Sorry about the inconvenience caused."),(0,n.kt)("h2",{id:"raw-release-notes-2"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12351209"},"here"),"."),(0,n.kt)("h2",{id:"release-0110-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.11.0"},"Release 0.11.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.11.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-2"},"Migration Guide"),(0,n.kt)("h3",{id:"bundle-usage-updates"},"Bundle usage updates"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Spark bundle for 3.0.x is no longer officially supported. Users are encouraged to upgrade to Spark 3.2 or 3.1."),(0,n.kt)("li",{parentName:"ul"},"Users are encouraged to use bundles with specific Spark version in the name (",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-sparkX.Y-bundle"),") and move away\nfrom the legacy bundles (",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark-bundle")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3-bundle"),")."),(0,n.kt)("li",{parentName:"ul"},"Spark or Utilities bundle no longer requires additional ",(0,n.kt)("inlineCode",{parentName:"li"},"spark-avro")," package at runtime; the\noption ",(0,n.kt)("inlineCode",{parentName:"li"},"--package org.apache.spark:spark-avro_2.1*:*")," can be dropped.")),(0,n.kt)("h3",{id:"configuration-updates-1"},"Configuration updates"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"For MOR tables, ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.write.precombine.field")," is required for both write and read."),(0,n.kt)("li",{parentName:"ul"},"Only set ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.write.drop.partition.columns=true")," when work\nwith ",(0,n.kt)("a",{parentName:"li",href:"/docs/gcp_bigquery"},"BigQuery integration"),"."),(0,n.kt)("li",{parentName:"ul"},"For Spark readers that rely on extracting physical partition path,\nset ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.read.extract.partition.values.from.path=true")," to stay compatible with existing behaviors."),(0,n.kt)("li",{parentName:"ul"},"Default index type for Spark was changed from ",(0,n.kt)("inlineCode",{parentName:"li"},"BLOOM"),"\nto ",(0,n.kt)("inlineCode",{parentName:"li"},"SIMPLE")," (",(0,n.kt)("a",{parentName:"li",href:"https://issues.apache.org/jira/browse/HUDI-3091"},"HUDI-3091"),"). If you currently rely on the default ",(0,n.kt)("inlineCode",{parentName:"li"},"BLOOM"),"\nindex type, please update your configuration accordingly.")),(0,n.kt)("h2",{id:"release-highlights-3"},"Release Highlights"),(0,n.kt)("h3",{id:"multi-modal-index"},"Multi-Modal Index"),(0,n.kt)("p",null,"In 0.11.0, we enable the ",(0,n.kt)("a",{parentName:"p",href:"/docs/metadata"},"metadata table")," with synchronous updates and metadata-table-based file listing\nby default for Spark writers, to improve the performance of partition and file listing on large Hudi tables. On the\nreader side, users need to set it to ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," benefit from it. The metadata table and related file listing functionality\ncan still be turned off by setting ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=false"),". Due to this, users deploying Hudi with async table\nservices need to configure a locking service. If this feature is not relevant for you, you can set\n",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=false")," additionally and use Hudi as before."),(0,n.kt)("p",null,"We introduce a multi-modal index in metadata table to drastically improve the lookup performance in file index and query\nlatency with data skipping. Two new indices are added to the metadata table"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"bloom filter index containing the file-level bloom filter to facilitate key lookup and file pruning as a part of\nbloom index during upserts by the writers"),(0,n.kt)("li",{parentName:"ol"},"column stats index containing the statistics of all/interested columns to improve file pruning based on key and\ncolumn value range in both the writer and the reader, in query planning in Spark for example.")),(0,n.kt)("p",null,"They are disabled by default. You can enable them by setting ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.index.bloom.filter.enable"),"\nand ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.index.column.stats.enable")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"true"),", respectively."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Refer to the ",(0,n.kt)("a",{parentName:"em",href:"/docs/metadata#deployment-considerations"},"metadata table guide")," for detailed instructions on upgrade and\ndeployment.")),(0,n.kt)("h3",{id:"data-skipping-with-metadata-table"},"Data Skipping with Metadata Table"),(0,n.kt)("p",null,"With the added support for Column Statistics in metadata table, Data Skipping is now relying on the metadata table's\nColumn Stats Index (CSI) instead of its own bespoke index implementation (comparing to Spatial Curves added in 0.10.0),\nallowing to leverage Data Skipping for all datasets regardless of whether they execute layout optimization procedures (\nlike clustering) or not. To benefit from Data Skipping, make sure to set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.enable.data.skipping=true")," on both\nwriter and reader, as well as enable metadata table and Column Stats Index in the metadata table."),(0,n.kt)("p",null,'Data Skipping supports standard functions (as well as some common expressions) allowing you to apply common standard\ntransformations onto the raw data in your columns within your query\'s filters. For example, if you have column "ts" that\nstores timestamp as string, you can now query it using human-readable dates in your predicate like\nfollowing: ',(0,n.kt)("inlineCode",{parentName:"p"},'date_format(ts, "MM/dd/yyyy" ) < "04/01/2022"'),"."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Note: Currently Data Skipping is only supported in COW tables and MOR tables in read-optimized mode. The work of full\nsupport for MOR tables is tracked in ",(0,n.kt)("a",{parentName:"em",href:"https://issues.apache.org/jira/browse/HUDI-3866"},"HUDI-3866"))),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Refer to the ",(0,n.kt)("a",{parentName:"em",href:"/docs/performance#read-path"},"performance")," guide for more info.")),(0,n.kt)("h3",{id:"async-indexer"},"Async Indexer"),(0,n.kt)("p",null,"In 0.11.0, we added a new asynchronous service for indexing to our rich set of table services. It allows users to create\ndifferent kinds of indices (e.g., files, bloom filters, and column stats) in the metadata table without blocking\ningestion. The indexer adds a new action ",(0,n.kt)("inlineCode",{parentName:"p"},"indexing")," on the timeline. While the indexing process itself is asynchronous\nand non-blocking to writers, a lock provider needs to be configured to safely co-ordinate the process with the inflight\nwriters."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"See the ",(0,n.kt)("a",{parentName:"em",href:"/docs/metadata_indexing"},"indexing guide")," for more details.")),(0,n.kt)("h3",{id:"spark-datasource-improvements"},"Spark DataSource Improvements"),(0,n.kt)("p",null,"Hudi's Spark low-level integration got considerable overhaul consolidating common flows to share the infrastructure and\nbring both compute and data throughput efficiencies when querying the data."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"MOR queries with no log files (except for incremental queries) tables are now leveraging Vectorized Parquet reader while reading\nthe data, meaning that Parquet reader is now able to leverage modern processors vectorized instructions to further\nspeed up decoding of the data. Enabled by default."),(0,n.kt)("li",{parentName:"ul"},"When standard Record Payload implementation is used (e.g., ",(0,n.kt)("inlineCode",{parentName:"li"},"OverwriteWithLatestAvroPayload"),"), MOR table will only\nfetch ",(0,n.kt)("em",{parentName:"li"},"strictly necessary"),' columns (primary key, pre-combine key) on top of those referenced by the query,\nsubstantially reducing wasted data throughput as well as compute spent on decompressing and decoding the data. This is\nsignificantly beneficial to "wide" MOR tables with 1000s of columns, for example.')),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"See the ",(0,n.kt)("a",{parentName:"em",href:"#migration-guide"},"migration guide")," for the relevant configuration updates.")),(0,n.kt)("h3",{id:"schema-on-read-for-spark"},"Schema-on-read for Spark"),(0,n.kt)("p",null,"In 0.11.0, users can now easily change the current schema of a Hudi table to adapt to the evolving data schema over\ntime. Spark SQL DDL support (experimental) was added for Spark 3.1.x and Spark 3.2.1 via ",(0,n.kt)("inlineCode",{parentName:"p"},"ALTER TABLE")," syntax."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Please refer to the ",(0,n.kt)("a",{parentName:"em",href:"/docs/schema_evolution"},"schema evolution guide")," for more details.")),(0,n.kt)("h3",{id:"spark-sql-improvements"},"Spark SQL Improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Users can update or delete records in Hudi tables using non-primary-key fields."),(0,n.kt)("li",{parentName:"ul"},"Time travel query is now supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"timestamp as of")," syntax. (Spark 3.2+ only)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CALL")," command is added to support invoking more actions on Hudi tables.")),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Please refer to the ",(0,n.kt)("a",{parentName:"em",href:"/docs/quick-start-guide"},"Quick Start - Spark Guide")," for more details and examples.")),(0,n.kt)("h3",{id:"spark-versions-and-bundles"},"Spark Versions and Bundles"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Spark 3.2 support is added; users who are on Spark 3.2 can use ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3.2-bundle")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3-bundle")," (legacy bundle name)."),(0,n.kt)("li",{parentName:"ul"},"Spark 3.1 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark3.1-bundle"),"."),(0,n.kt)("li",{parentName:"ul"},"Spark 2.4 will continue to be supported via ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark2.4-bundle")," or ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-spark-bundle")," (legacy bundle name).")),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"See the ",(0,n.kt)("a",{parentName:"em",href:"#migration-guide"},"migration guide")," for usage updates.")),(0,n.kt)("h3",{id:"slim-utilities-bundle"},"Slim Utilities Bundle"),(0,n.kt)("p",null,"In 0.11.0, a new ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-utilities-slim-bundle")," is added to exclude dependencies that could cause conflicts and\ncompatibility issues with other frameworks such as Spark. ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-utilities-slim-bundle")," is to work with a chosen Spark\nbundle:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"hudi-utilities-slim-bundle")," works with Spark 3.1 and 2.4."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"hudi-utilities-bundle")," continues to work with Spark 3.1 as it does in Hudi 0.10.x.")),(0,n.kt)("h3",{id:"flink-integration-improvements-1"},"Flink Integration Improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"In 0.11.0, both Flink 1.13.x and 1.14.x are supported."),(0,n.kt)("li",{parentName:"ul"},"Complex data types such as ",(0,n.kt)("inlineCode",{parentName:"li"},"Map")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"Array")," are supported. Complex data types can be nested in another component data\ntype."),(0,n.kt)("li",{parentName:"ul"},"A DFS-based Flink catalog is added with catalog identifier as ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi"),". You can instantiate the catalog through API\ndirectly or use the ",(0,n.kt)("inlineCode",{parentName:"li"},"CREATE CATALOG")," syntax to create it."),(0,n.kt)("li",{parentName:"ul"},"Flink supports ",(0,n.kt)("a",{parentName:"li",href:"#bucket-index"},"Bucket Index")," in normal ",(0,n.kt)("inlineCode",{parentName:"li"},"UPSERT")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"BULK_INSERT")," operations. Different from the\ndefault Flink state-based index, bucket index is in constant number of buckets. Specify SQL option ",(0,n.kt)("inlineCode",{parentName:"li"},"index.type"),"\nas ",(0,n.kt)("inlineCode",{parentName:"li"},"BUCKET")," to enable it.")),(0,n.kt)("h3",{id:"google-bigquery-integration"},"Google BigQuery Integration"),(0,n.kt)("p",null,"In 0.11.0, Hudi tables can be queried from BigQuery as external tables. Users can\nset ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.gcp.bigquery.BigQuerySyncTool")," as the sync tool implementation for ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieDeltaStreamer")," and make\nthe target Hudi table discoverable in BigQuery. Please refer to the ",(0,n.kt)("a",{parentName:"p",href:"/docs/gcp_bigquery"},"BigQuery integration")," guide\npage for more details."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Note: this is an experimental feature and only works with hive-style partitioned Copy-On-Write tables.")),(0,n.kt)("h3",{id:"aws-glue-meta-sync"},"AWS Glue Meta Sync"),(0,n.kt)("p",null,"In 0.11.0, Hudi tables can be sync'ed to AWS Glue Data Catalog via AWS SDK directly. Users can\nset ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.aws.sync.AwsGlueCatalogSyncTool")," as the sync tool implementation for ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieDeltaStreamer")," and make\nthe target Hudi table discoverable in Glue catalog. Please refer\nto ",(0,n.kt)("a",{parentName:"p",href:"/docs/syncing_aws_glue_data_catalog"},"Sync to AWS Glue Data Catalog")," guide page for more details."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Note: this is an experimental feature.")),(0,n.kt)("h3",{id:"datahub-meta-sync"},"DataHub Meta Sync"),(0,n.kt)("p",null,"In 0.11.0, Hudi table's metadata (specifically, schema and last sync commit time) can be sync'ed\nto ",(0,n.kt)("a",{parentName:"p",href:"https://datahubproject.io/"},"DataHub"),". Users can set ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.sync.datahub.DataHubSyncTool")," as the sync tool\nimplementation for ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieDeltaStreamer")," and sync the target table as a Dataset in DataHub. Please refer\nto ",(0,n.kt)("a",{parentName:"p",href:"/docs/syncing_datahub"},"Sync to DataHub")," guide page for more details."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"Note: this is an experimental feature.")),(0,n.kt)("h3",{id:"encryption"},"Encryption"),(0,n.kt)("p",null,"In 0.11.0, Spark 3.2 support has been added and accompanying that, Parquet 1.12 has been included, which brings\nencryption feature to Hudi (Copy-on-Write tables). Please refer to ",(0,n.kt)("a",{parentName:"p",href:"/docs/encryption"},"Encryption")," guide page for more\ndetails."),(0,n.kt)("h3",{id:"bucket-index"},"Bucket Index"),(0,n.kt)("p",null,"Bucket index, an efficient and light-weight index type, is added in 0.11.0. It distributes records to buckets using a\nhash function based on the record keys, where each bucket corresponds to a single file group. To use this index, set the\nindex type to ",(0,n.kt)("inlineCode",{parentName:"p"},"BUCKET")," and set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.storage.layout.partitioner.class")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.table.action.commit.SparkBucketIndexPartitioner"),".\nFor Flink, set ",(0,n.kt)("inlineCode",{parentName:"p"},"index.type=BUCKET"),"."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"For more details, please refer to hoodie.bucket.index.","*"," in the ",(0,n.kt)("a",{parentName:"em",href:"/docs/configurations"},"configurations page"),".")),(0,n.kt)("h3",{id:"savepoint--restore"},"Savepoint & Restore"),(0,n.kt)("p",null,"Disaster recovery is a mission critical feature in any production deployment. Especially when it comes to systems that\nstore data. Hudi had savepoint and restore functionality right from the beginning for COW tables. In 0.11.0, we have\nadded support for MOR tables."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"More info about this feature can be found in ",(0,n.kt)("a",{parentName:"em",href:"/docs/disaster_recovery"},"Disaster Recovery"),".")),(0,n.kt)("h3",{id:"pulsar-write-commit-callback"},"Pulsar Write Commit Callback"),(0,n.kt)("p",null,"Hudi users can use ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.callback.HoodieWriteCommitCallback")," to invoke callback function upon successful\ncommits. In 0.11.0, we add ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieWriteCommitPulsarCallback")," in addition to the existing HTTP callback and Kafka\ncallback. Please refer to the ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#Write-commit-pulsar-callback-configs"},"configurations page")," for\ndetailed settings."),(0,n.kt)("h3",{id:"hiveschemaprovider"},"HiveSchemaProvider"),(0,n.kt)("p",null,"In 0.11.0, ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.utilities.schema.HiveSchemaProvider")," is added for getting schema from user-defined hive\ntables. This is useful when tailing Hive tables in ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieDeltaStreamer")," instead of having to provide avro schema files."),(0,n.kt)("h2",{id:"known-regression"},"Known Regression"),(0,n.kt)("p",null,"In 0.11.0 release, with the newly added support for Spark SQL features, the following performance regressions were\ninadvertently introduced:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Partition pruning for some of the COW tables is not applied properly"),(0,n.kt)("li",{parentName:"ul"},"Spark SQL query caching (which caches parsed and resolved queries) was not working correctly resulting in additional"),(0,n.kt)("li",{parentName:"ul"},"overhead to re-analyze the query every time when it's executed (listing the table contents, etc.)")),(0,n.kt)("p",null,"All of these issues have been addressed in 0.11.1 and are validated to be resolved by benchmarking the set of changes\non TPC-DS against 0.10.1."),(0,n.kt)("p",null,"In HUDI-2761, HUDI-3576 and HUDI-4279, we did several attempts to optimize the efficiency of embedded timeline server,\nbut in some cases, these changes would cause silent data loss, the affected table types include both COW and MOR table,\nthis bug has been addressed in release 0.12.0."),(0,n.kt)("h2",{id:"raw-release-notes-3"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12350673"},"here")),(0,n.kt)("h2",{id:"release-0100-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.10.0"},"Release 0.10.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.10.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-3"},"Migration Guide"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If migrating from an older release, please also check the upgrade instructions for each subsequent release below."),(0,n.kt)("li",{parentName:"ul"},"With 0.10.0, we have made some foundational fix to metadata table and so as part of upgrade, any existing metadata table is cleaned up.\nWhenever Hudi is launched with newer table version i.e 3 (or moving from an earlier release to 0.10.0), an upgrade step will be executed automatically.\nThis automatic upgrade step will happen just once per Hudi table as the hoodie.table.version will be updated in property file after upgrade is completed."),(0,n.kt)("li",{parentName:"ul"},"Similarly, a command line tool for Downgrading (command - downgrade) is added if in case some users want to downgrade Hudi\nfrom table version 3 to 2 or move from Hudi 0.10.0 to pre 0.10.0. This needs to be executed from a 0.10.0 hudi-cli binary/script."),(0,n.kt)("li",{parentName:"ul"},"We have made some major fixes to 0.10.0 release around metadata table and would recommend users to try out metadata\nfor better performance from optimized file listings. As part of the upgrade, please follow the below steps to enable metadata table.")),(0,n.kt)("h3",{id:"prerequisites-for-enabling-metadata-table"},"Prerequisites for enabling metadata table"),(0,n.kt)("p",null,"Hudi writes and reads have to perform \u201clist files\u201d operation on the file system to get the current view of the system.\nThis could be very costly in cloud stores which could throttle your requests depending on the scale/size of your dataset.\nSo, we introduced a metadata table in 0.7.0 to cache the file listing for the table. With 0.10.0, we have made a foundational fix\nto the metadata table with synchronous updates instead of async updates to simplify the overall design and to assist in\nbuilding future enhancements like multi-modal indexing. This can be turned on using the config hoodie.metadata.enable.\nBy default, metadata table based file listing feature is disabled."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Deployment Model")," 1 : If your current deployment model is single writer and all table services (cleaning, clustering, compaction) are configured to be ",(0,n.kt)("strong",{parentName:"p"},"inline"),",\nthen you can turn on the metadata table without needing any additional configuration."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Deployment Model")," 2 : If your current deployment model is ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/concurrency_control"},"multi writer"),"\nalong with ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/concurrency_control#enabling-multi-writing"},"lock providers")," configured,\nthen you can turn on the metadata table without needing any additional configuration."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Deployment Model 3")," : If your current deployment model is single writer along with async table services (such as cleaning, clustering, compaction) configured,\nthen it is a must to have the lock providers configured before turning on the metadata table.\nEven if you have already had a metadata table turned on, and your deployment model employs async table services,\nthen it is  a must to have lock providers configured before upgrading to this release."),(0,n.kt)("h3",{id:"upgrade-steps"},"Upgrade steps"),(0,n.kt)("p",null,"For deployment mode 1, restarting the Single Writer with 0.10.0 is sufficient to upgrade the table."),(0,n.kt)("p",null,"For deployment model 2 with multi-writers, you can bring up the writers with 0.10.0 sequentially.\nIf you intend to use the metadata table, it is a must to have the ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/configurations/#hoodiemetadataenable"},"metadata config")," enabled across all the writers.\nOtherwise, it will lead to loss of data from the inconsistent writer."),(0,n.kt)("p",null,"For deployment model 3 with single writer and async table services, restarting the single writer along with async services is sufficient to upgrade the table.\nIf async services are configured to run separately from the writer, then it is a must to have a consistent metadata config across all writers and async jobs.\nRemember to configure the lock providers as detailed above if enabling the metadata table."),(0,n.kt)("p",null,"To leverage the metadata table based file listings, readers must have metadata config turned on explicitly while querying.\nIf not, readers will not leverage the file listings from the metadata table."),(0,n.kt)("h3",{id:"spark-sql-primary-key-requirements"},"Spark-SQL primary key requirements"),(0,n.kt)("p",null,"Spark SQL in Hudi requires ",(0,n.kt)("inlineCode",{parentName:"p"},"primaryKey")," to be specified by tblproperites or options in sql statement.\nFor update and delete operations, ",(0,n.kt)("inlineCode",{parentName:"p"},"preCombineField")," is required as well. These requirements align with\nHudi datasource writer\u2019s and the alignment resolves many behavioural discrepancies reported in previous versions."),(0,n.kt)("p",null,"To specify ",(0,n.kt)("inlineCode",{parentName:"p"},"primaryKey"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"preCombineField")," or other hudi configs, ",(0,n.kt)("inlineCode",{parentName:"p"},"tblproperties")," is a preferred way than ",(0,n.kt)("inlineCode",{parentName:"p"},"options"),".\nSpark SQL syntax is detailed ",(0,n.kt)("a",{parentName:"p",href:"https://spark.apache.org/docs/latest/sql-ref-syntax-ddl-create-table-datasource.html"},"DDL CREATE TABLE"),".\nIn summary, any Hudi table created pre 0.10.0 without a ",(0,n.kt)("inlineCode",{parentName:"p"},"primaryKey")," need to be recreated with a ",(0,n.kt)("inlineCode",{parentName:"p"},"primaryKey")," field with 0.10.0.\nWe plan to remove the need for primary keys in future versions more holistically."),(0,n.kt)("h2",{id:"release-highlights-4"},"Release Highlights"),(0,n.kt)("h3",{id:"kafka-connect"},"Kafka Connect"),(0,n.kt)("p",null,"In 0.10.0, we are adding a Kafka Connect Sink for Hudi that provides the ability for users to ingest/stream records from Apache Kafka to Hudi Tables.\nWhile users can already stream Kafka records into Hudi tables using deltastreamer, the Kafka connect sink offers greater flexibility\nto current users of Kafka connect sinks such as S3, HDFS, etc to additionally sink their data to a data lake.\nIt also helps users who do not want to deploy and operate spark.  The sink is currently experimental,\nand users can quickly get started by referring to the detailed steps in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/master/hudi-kafka-connect/README.md"},"README"),".\nFor users who are curious about the internals, you can refer to the ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC-32+Kafka+Connect+Sink+for+Hudi"},"RFC"),"."),(0,n.kt)("h3",{id:"z-ordering-hilbert-curves-and-data-skipping"},"Z-Ordering, Hilbert Curves and Data Skipping"),(0,n.kt)("p",null,"In 0.10.0 we\u2019re bringing (in experimental mode) support for indexing based on space-filling curves ordering initially\nsupporting ",(0,n.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Z-order_curve"},"Z-order")," and ",(0,n.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Hilbert_curve"},"Hilbert curves"),"."),(0,n.kt)("p",null,"Data skipping is crucial in optimizing query performance. Enabled by the Column Statistics Index containing column level stats (like min, max, number of nulls, etc)\nfor individual data files, allows to quickly prune (for some queries) the search space by excluding files that are guaranteed\nnot to contain the values of interest for the query in question. Effectiveness of Data Skipping is maximized\nwhen data is globally ordered by the columns, allowing individual Parquet files to contain disjoint ranges of values,\nallowing for more effective pruning."),(0,n.kt)("p",null,"Using space-filling curves (like Z-order, Hilbert, etc) allows to effectively order rows in your table based on sort-key\ncomprising multiple columns, while preserving very important property: ordering of the rows using space-filling curve\non multi-column key will preserve within itself the ordering by each individual column as well.\nThis property comes very handy in use-cases when rows need to be ordered by complex multi-column sort keys,\nwhich need to be queried efficiently by any subset of they key (not necessarily key\u2019s prefix), making space-filling curves stand out\nfrom plain and simple linear (or lexicographical) multi-column ordering. Using space-filling curves in such use-cases might bring order(s)\nof magnitude speed-up in your queries' performance by considerably reducing search space, if applied appropriately."),(0,n.kt)("p",null,"These features are currently experimental, we\u2019re planning to dive into more details showcasing real-world application\nof the space-filling curves in a blog post soon."),(0,n.kt)("h3",{id:"debezium-deltastreamer-sources"},"Debezium Deltastreamer sources"),(0,n.kt)("p",null,"We have added two new debezium sources to our deltastreamer ecosystem. Debezium is an open source distributed platform for change data capture(CDC).\nWe have added PostgresDebeziumSource and MysqlDebeziumSource to route CDC logs into Apache Hudi via deltastreamer for postgres and my sql db respectively.\nWith this capability, we can continuously capture row-level changes that insert, update and delete records that were committed to a database and ingest to hudi."),(0,n.kt)("h3",{id:"external-config-file-support"},"External config file support"),(0,n.kt)("p",null,"Instead of directly and sometimes passing configurations to every Hudi job, since 0.10.0 users can now pass in configuration via a configuration file ",(0,n.kt)("inlineCode",{parentName:"p"},"hudi-default.conf"),".\nBy default, Hudi would load the configuration file under /etc/hudi/conf directory. You can specify a different configuration directory location\nby setting the ",(0,n.kt)("strong",{parentName:"p"},"HUDI_CONF_DIR")," environment variable. This can be useful for uniformly enforcing often repeated configs\nlike Hive sync settings, write/index tuning parameters, across your entire data lake."),(0,n.kt)("h3",{id:"metadata-table"},"Metadata table"),(0,n.kt)("p",null,"With 0.10.0, we have made a foundational fix to the metadata table with synchronous updates instead of async updates\nto simplify the overall design and to assist in building future enhancements. This can be turned on using the config ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/configurations/#hoodiemetadataenable"},"hoodie.metadata.enable"),".\nBy default, metadata table based file listing feature is disabled. We have few following up tasks we are looking to fix by 0.11.0.\nYou can follow ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/browse/HUDI-1292"},"HUDI-1292")," umbrella ticket for further details.\nPlease refer to the Migration guide section before turning on the metadata table."),(0,n.kt)("h3",{id:"documentation-overhaul"},"Documentation overhaul"),(0,n.kt)("p",null,"Documentation was added for many pre-existing features that were previously missing docs. We reorganised the documentation\nlayout to improve discoverability and help new users ramp up on Hudi. We made many doc improvements based on community feedback.\nSee the latest docs at: ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/overview"},"overview"),"."),(0,n.kt)("h2",{id:"writer-side-improvements"},"Writer side improvements"),(0,n.kt)("p",null,"Commit instant time format have been upgraded to ms granularity from secs granularity. Users don\u2019t have to do any special handling in this,\nregular upgrade should work smoothly."),(0,n.kt)("p",null,"Deltastreamer:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"ORCDFSSource has been added to support orc files with DFSSource."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"S3EventsHoodieIncrSource")," can now fan-out multiple tables off a single S3 metadata table.")),(0,n.kt)("p",null,"Clustering:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"We have added support to retain same file groups with clustering to cater to the requirements of external index.\nIncremental timeline support has been added for pending clustering operations.")),(0,n.kt)("h3",{id:"dynamodb-based-lock-provider"},"DynamoDB based lock provider"),(0,n.kt)("p",null,"Hudi added support for multi-writers in 0.7.0 and as part of it, users are required to configure lock service providers.\nIn 0.10.0, we are adding DynamoDBBased lock provider that users can make use of. To configure this lock provider, users have to set the below configs:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"hoodie.write.lock.provider=org.apache.hudi.aws.transaction.lock.DynamoDBBasedLockProvider\nHoodie.write.lock.dynamodb.table\nHoodie.write.lock.dynamodb.partition_keyhoodie.write.lock.dynamodb.region\n")),(0,n.kt)("p",null,"Also, to set up the credentials for accessing AWS resources, users can set the below property:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"hoodie.aws.access.keyhoodie.aws.secret.keyhoodie.aws.session.token\n")),(0,n.kt)("p",null,"More details on concurrency control are covered ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/concurrency_control"},"here"),"."),(0,n.kt)("h3",{id:"default-flips"},"Default flips"),(0,n.kt)("p",null,"We have flipped defaults for all shuffle parallelism configs in hudi from 1500 to 200. The configs of interest are ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodieinsertshuffleparallelism"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.insert.shuffle.parallelism")),",\n",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodiebulkinsertshuffleparallelism"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.bulkinsert.shuffle.parallelism")),",\n",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodieupsertshuffleparallelism"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.upsert.shuffle.parallelism"))," and\n",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodiedeleteshuffleparallelism"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.delete.shuffle.parallelism")),".\nIf you have been relying on the default settings, just watch out after upgrading. We have tested these configs at a reasonable scale though."),(0,n.kt)("p",null,"We have enabled the rollback strategy to use marker based from listing based. And we have also made timeline server based\nmarkers as default with this release. You can read more on the timeline server based markers ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/blog/2021/08/18/improving-marker-mechanism"},"here"),"."),(0,n.kt)("p",null,"Clustering: Default plan strategy changed to ",(0,n.kt)("inlineCode",{parentName:"p"},"SparkSizeBasedClusteringPlanStrategy"),". By default, commit metadata will be preserved when clustering.\nIt will be useful for incremental query support with replace commits in the timeline."),(0,n.kt)("h3",{id:"spark-sql-improvements-1"},"Spark SQL improvements"),(0,n.kt)("p",null,"We have made more improvements to spark-sql like adding support for ",(0,n.kt)("inlineCode",{parentName:"p"},"MERGE INTO")," to work with non-primary keys,\nand added support for new operations like ",(0,n.kt)("inlineCode",{parentName:"p"},"SHOW PARTITIONS")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"DROP PARTITIONS"),"."),(0,n.kt)("h2",{id:"query-side-improvements"},"Query side improvements"),(0,n.kt)("p",null,"Hive Incremental query support and partition pruning for snapshot query has been added for MOR table. Support has been added for incremental read with clustering commit."),(0,n.kt)("p",null,"We have improved the listing logic to gain 65% on query time and 2.8x parallelism on Presto queries against the Hudi tables."),(0,n.kt)("p",null,"In general, we have made a lot of bug fixes (multi writers, archival, rollbacks, metadata, clustering, etc) and stability fixes in this release.\nAnd have improved our CLI around metadata and clustering commands. Hoping users will have a smoother ride with hudi 0.10.0."),(0,n.kt)("h2",{id:"flink-integration-improvements-2"},"Flink Integration Improvements"),(0,n.kt)("p",null,"Flink reader now supports incremental read, set ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.query.type")," as ",(0,n.kt)("inlineCode",{parentName:"p"},"incremental")," to enable for batch execution mode.\nConfigure option ",(0,n.kt)("inlineCode",{parentName:"p"},"read.start-commit")," to specify the reading start commit, configure option ",(0,n.kt)("inlineCode",{parentName:"p"},"read.end-commit"),"\nto specify the end commit (both are inclusive). Streaming reader can also specify the start offset with the same option ",(0,n.kt)("inlineCode",{parentName:"p"},"read.start-commit"),"."),(0,n.kt)("p",null,"Upsert operation is now supported for batch execution mode, use ",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT INTO")," syntax to update the existing data set."),(0,n.kt)("p",null,"For non-updating data set like the log data, flink writer now supports appending the new data set directly without merging,\nthis now becomes the default mode for Copy On Write table type with ",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT")," operation,\nby default, the writer does not merge the existing small files, set option ",(0,n.kt)("inlineCode",{parentName:"p"},"write.insert.cluster")," as ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," to enable merging of the small files."),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"write.precombine.field")," now becomes optional(not a required option) for flink writer, when the field is not specified,\nif there is a field named ",(0,n.kt)("inlineCode",{parentName:"p"},"ts")," in the table schema, the writer use it as the preCombine field,\nor the writer compares records by processing sequence: always choose later records."),(0,n.kt)("p",null,"The small file strategy is tweaked to be more stable, with the new strategy, each bucket assign task manages a subset of filegroups separately,\nthat means, the parallelism of bucket assign task would affect the number of small files."),(0,n.kt)("p",null,"The metadata table is also supported for flink writer and reader, metadata table can reduce the partition lookup and file listing obviously for the underneath storage for both writer and reader side.\nSet option ",(0,n.kt)("inlineCode",{parentName:"p"},"metadata.enabled")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," to enable this feature."),(0,n.kt)("h2",{id:"ecosystem"},"Ecosystem"),(0,n.kt)("h3",{id:"dbt-support"},"DBT support"),(0,n.kt)("p",null,"We've made it so much easier to create derived hudi datasets by integrating with the very popular data transformation tool (dbt).\nWith 0.10.0, users can create incremental hudi datasets using dbt. Please see this PR for details ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/dbt-labs/dbt-spark/issues/187"},"https://github.com/dbt-labs/dbt-spark/issues/187")),(0,n.kt)("h3",{id:"monitoring"},"Monitoring"),(0,n.kt)("p",null,"Hudi now supports publishing metrics to Amazon CloudWatch. It can be configured by setting ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodiemetricsreportertype"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.metrics.reporter.type"))," to \u201cCLOUDWATCH\u201d.\nStatic AWS credentials to be used can be configured using ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodieawsaccesskey"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.aws.access.key")),",\n",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodieawssecretkey"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.aws.secret.key")),",\n",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/next/configurations#hoodieawssessiontoken"},(0,n.kt)("inlineCode",{parentName:"a"},"hoodie.aws.session.token"))," properties.\nIn the absence of static AWS credentials being configured, ",(0,n.kt)("inlineCode",{parentName:"p"},"DefaultAWSCredentialsProviderChain")," will be used to get credentials by checking environment properties.\nAdditional Amazon CloudWatch reporter specific properties that can be tuned are in the ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieMetricsCloudWatchConfig")," class."),(0,n.kt)("h3",{id:"devex"},"DevEx"),(0,n.kt)("p",null,"Default maven spark3 version is not upgraded to 3.1 So, ",(0,n.kt)("inlineCode",{parentName:"p"},"maven profile -Dspark3")," will build Hudi against Spark 3.1.2 with 0.10.0. Use ",(0,n.kt)("inlineCode",{parentName:"p"},"-Dspark3.0.x")," for building against Spark 3.0.x versions"),(0,n.kt)("h3",{id:"repair-tool-for-dangling-data-files"},"Repair tool for dangling data files"),(0,n.kt)("p",null,"Sometimes, there could be dangling data files lying around due to various reasons ranging from rollback failing mid-way\nto cleaner failing to clean up all data files, or data files created by spark task failures were not cleaned up properly.\nSo, we are adding a repair tool to clean up any dangling data files which are not part of completed commits. Feel free to try out\nthe tool via spark-submit at ",(0,n.kt)("inlineCode",{parentName:"p"},"org.apache.hudi.utilities.HoodieRepairTool")," in hudi-utilities bundle, if you encounter issues in 0.10.0 release.\nThe tool has dry run mode as well which would print the dangling files without actually deleting it. The tool is available\nfrom 0.11.0-SNAPSHOT on master."),(0,n.kt)("h2",{id:"raw-release-notes-4"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12350285"},"here")),(0,n.kt)("h2",{id:"release-090-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.9.0"},"Release 0.9.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.9.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-for-this-release"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If migrating from an older release, please also check the upgrade instructions for each subsequent release below."),(0,n.kt)("li",{parentName:"ul"},"With 0.9.0, Hudi is adding more table properties to aid in using an existing hudi table with spark-sql.\nTo smoothly aid this transition these properties added to ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.properties")," file. Whenever Hudi is launched with\nnewer table version i.e 2 (or moving from pre 0.9.0 to 0.9.0), an upgrade step will be executed automatically.\nThis automatic upgrade step will happen just once per Hudi table as the ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.table.version")," will be updated in\nproperty file after upgrade is completed."),(0,n.kt)("li",{parentName:"ul"},"Similarly, a command line tool for Downgrading (command - ",(0,n.kt)("inlineCode",{parentName:"li"},"downgrade"),") is added if in case some users want to\ndowngrade Hudi from table version ",(0,n.kt)("inlineCode",{parentName:"li"},"2")," to ",(0,n.kt)("inlineCode",{parentName:"li"},"1")," or move from Hudi 0.9.0 to pre 0.9.0. This needs to be executed from a\n0.9.0 ",(0,n.kt)("inlineCode",{parentName:"li"},"hudi-cli")," binary/script."),(0,n.kt)("li",{parentName:"ul"},"With this release, we added a new framework to track config properties in code, moving away from string variables that\nhold property names and values. This move helps us automate configuration doc generation and much more. While we still\nsupport the older configs string variables, users are encouraged to use the new ",(0,n.kt)("inlineCode",{parentName:"li"},"ConfigProperty")," equivalents, as noted\nin the deprecation notices. In most cases, it is as simple as calling ",(0,n.kt)("inlineCode",{parentName:"li"},".key()")," and ",(0,n.kt)("inlineCode",{parentName:"li"},".defaultValue()")," on the corresponding\nalternative. e.g ",(0,n.kt)("inlineCode",{parentName:"li"},"RECORDKEY_FIELD_OPT_KEY")," can be replaced by ",(0,n.kt)("inlineCode",{parentName:"li"},"RECORDKEY_FIELD_NAME.key()")),(0,n.kt)("li",{parentName:"ul"},"If set ",(0,n.kt)("inlineCode",{parentName:"li"},"URL_ENCODE_PARTITIONING_OPT_KEY=true")," ",(0,n.kt)("em",{parentName:"li"},"and")," ",(0,n.kt)("inlineCode",{parentName:"li"},"<")," and ",(0,n.kt)("inlineCode",{parentName:"li"},">")," are present in the URL partition paths, users would\nneed to migrate the table due to encoding logic changed: ",(0,n.kt)("inlineCode",{parentName:"li"},"<")," (encoded as ",(0,n.kt)("inlineCode",{parentName:"li"},"%3C"),") and ",(0,n.kt)("inlineCode",{parentName:"li"},">")," (encoded as ",(0,n.kt)("inlineCode",{parentName:"li"},"%3E"),") won't be escaped in 0.9.0.")),(0,n.kt)("h2",{id:"release-highlights-5"},"Release Highlights"),(0,n.kt)("h3",{id:"spark-sql-dml-and-ddl-support"},"Spark SQL DML and DDL Support"),(0,n.kt)("p",null,"0.9.0 adds ",(0,n.kt)("strong",{parentName:"p"},"experimental")," support for DDL/DMLs using Spark SQL, taking a huge step towards making Hudi more easily accessible and\noperable by all personas (non-engineers, analysts etc). Users can now use ",(0,n.kt)("inlineCode",{parentName:"p"},"CREATE TABLE....USING HUDI")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"CREATE TABLE .. AS SELECT"),"\nstatements to directly create and manage tables in catalogs like Hive. Users can then use ",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"UPDATE"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"MERGE INTO")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"DELETE"),"\nsql statements to manipulate data. In addition, ",(0,n.kt)("inlineCode",{parentName:"p"},"INSERT OVERWRITE")," statement can be used to overwrite existing data in the table or partition\nfor existing batch ETL pipelines. For more information, checkout our docs ",(0,n.kt)("a",{parentName:"p",href:"/docs/quick-start-guide"},"here")," clicking on ",(0,n.kt)("inlineCode",{parentName:"p"},"SparkSQL")," tab.\nPlease see ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+25%3A+Spark+SQL+Extension+For+Hudi"},"RFC-25"),"\nfor more implementation details."),(0,n.kt)("h3",{id:"query-side-improvements-1"},"Query side improvements"),(0,n.kt)("p",null,"Hudi tables are now registered with Hive as spark datasource tables, meaning Spark SQL on these tables now uses the datasource as well,\ninstead of relying on the Hive fallbacks within Spark, which are ill-maintained/cumbersome. This unlocks many optimizations such as the\nuse of Hudi's own ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-spark-datasource/hudi-spark/src/main/scala/org/apache/hudi/HoodieFileIndex.scala#L46"},"FileIndex"),"\nimplementation for optimized caching and the use of the Hudi metadata table, for faster listing of large tables. We have also added support for\n",(0,n.kt)("a",{parentName:"p",href:"/docs/quick-start-guide#time-travel-query"},"timetravel query"),", for spark datasource."),(0,n.kt)("h3",{id:"writer-side-improvements-1"},"Writer side improvements"),(0,n.kt)("p",null,"Virtual keys support has been added where users can avoid adding meta fields to hudi table and leverage existing fields to populate record keys and partition paths.\nOne needs to disable ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiepopulatemetafields"},"this")," config to enable virtual keys."),(0,n.kt)("p",null,"Bulk Insert operations using ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiedatasourcewriterowwriterenable"},"row writer enabled")," now supports pre-combining,\nsort modes and user defined partitioners and now turned on by default for fast inserts."),(0,n.kt)("p",null,"Hudi performs automatic cleanup of uncommitted data, which has now been enhanced to be performant over cloud storage, even for\nextremely large tables. Specifically, a new marker mechanism has been implemented leveraging the timeline server to perform\ncentrally co-ordinated batched read/write of file markers to underlying storage. You can turn this using this ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiewritemarkerstype"},"config")," and learn more\nabout it on this ",(0,n.kt)("a",{parentName:"p",href:"/blog/2021/08/18/improving-marker-mechanism"},"blog"),"."),(0,n.kt)("p",null,"Async Clustering support has been added to both DeltaStreamer and Spark Structured Streaming Sink. More on this can be found in this\n",(0,n.kt)("a",{parentName:"p",href:"/blog/2021/08/23/async-clustering"},"blog post"),". In addition, we have added a new utility class ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java"},"HoodieClusteringJob"),"\nto assist in building and executing a clustering plan together as a standalone spark job."),(0,n.kt)("p",null,"Users can choose to drop fields used to generate partition paths, using ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.datasource.write.drop.partition.columns=true"),", to support\nquerying of Hudi snapshots using systems like BigQuery, which cannot handle this."),(0,n.kt)("p",null,"Hudi uses different ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiecommonspillablediskmaptype"},"types of spillable maps"),", for internally handling merges (compaction, updates or even MOR snapshot queries). In 0.9.0, we have added\nsupport for ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiecommondiskmapcompressionenabled"},"compression")," for the bitcask style default option and introduced a new spillable map backed by rocksDB, which can be more performant for large\nbulk updates or working with large base file sizes."),(0,n.kt)("p",null,"Added a new write operation ",(0,n.kt)("inlineCode",{parentName:"p"},"delete_partition")," operation, with support in spark. Users can leverage this to delete older partitions in bulk, in addition to\nrecord level deletes. Deletion of specific partitions can be done using this ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#hoodiedatasourcewritepartitionstodelete"},"config"),"."),(0,n.kt)("p",null,"Support for Huawei Cloud Object Storage, BAIDU AFS storage format, Baidu BOS storage in Hudi."),(0,n.kt)("p",null,"A ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SparkPreCommitValidator.java"},"pre commit validator framework"),"\nhas been added for spark engine, which can used for DeltaStreamer and Spark Datasource writers. Users can leverage this to add any validations to be executed before committing writes to Hudi.\nThree validators come out-of-box"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryEqualityPreCommitValidator.java"},"org.apache.hudi.client.validator.SqlQueryEqualityPreCommitValidator")," can be used to validate for equality of rows before and after the commit."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryInequalityPreCommitValidator.java"},"org.apache.hudi.client.validator.SqlQueryInequalityPreCommitValidator")," can be used to validate for inequality of rows before and after the commit."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQuerySingleResultPreCommitValidator.java"},"org.apache.hudi.client.validator.SqlQuerySingleResultPreCommitValidator")," can be used to validate that a query on the table results in a specific value.")),(0,n.kt)("p",null,"These can be configured by setting ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.precommit.validators=<comma separated list of validator class names>"),". Users can also provide their own implementations by extending the abstract class ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SparkPreCommitValidator.java"},"SparkPreCommitValidator"),"\nand overriding this method"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"void validateRecordsBeforeAndAfter(Dataset<Row> before, \n                                   Dataset<Row> after, \n                                   Set<String> partitionsAffected)\n")),(0,n.kt)("h3",{id:"flink-integration-improvements-3"},"Flink Integration Improvements"),(0,n.kt)("p",null,"The Flink writer now supports propagation of CDC format for MOR table, by turning on the option ",(0,n.kt)("inlineCode",{parentName:"p"},"changelog.enabled=true"),". Hudi would then persist all change flags of each record,\nusing the streaming reader of Flink, user can do stateful computation based on these change logs. Note that when the table is compacted with async compaction service, all the\nintermediate changes are merged into one(last record), to only have UPSERT semantics."),(0,n.kt)("p",null,"Flink writing now also has most feature parity with spark writing, with addition of write operations like ",(0,n.kt)("inlineCode",{parentName:"p"},"bulk_insert"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"insert_overwrite"),", support for non-partitioned tables,\nautomatic cleanup of uncommitted data, global indexing support, hive style partitioning and handling of partition path updates. Writing also supports a new log append mode, where\nno records are de-duplicated and base files are directly written for each flush. To use this mode, set ",(0,n.kt)("inlineCode",{parentName:"p"},"write.insert.deduplicate=false"),"."),(0,n.kt)("p",null,"Flink readers now support streaming reads from COW/MOR tables. Deletions are emitted by default in streaming read mode, the downstream receives the DELETE message as a Hoodie record with empty payload."),(0,n.kt)("p",null,"Hive sync has been greatly improved by support different Hive versions(1.x, 2.x, 3.x). Hive sync can also now be done asynchronously."),(0,n.kt)("p",null,"Flink Streamer tool now supports transformers."),(0,n.kt)("h3",{id:"deltastreamer"},"DeltaStreamer"),(0,n.kt)("p",null,"We have enhanced Deltastreamer utility with 3 new sources."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JdbcSource.java"},"JDBC source")," can take a extraction SQL statement and\nincrementally fetch data out of sources supporting JDBC. This can be useful for e.g when reading data from RDBMS sources. Note that, this approach may need periodic re-bootstrapping to ensure data consistency, although being much simpler to operate over CDC based approaches."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/SqlSource.java"},"SQLSource")," takes a Spark SQL statement to fetch data out of existing tables and\ncan be very useful for easy SQL based backfills use-cases e.g: backfilling just one column for the past N months."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsHoodieIncrSource.java"},"S3EventsHoodieIncrSource")," and ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/bf5a52e51bbeaa089995335a0a4c55884792e505/hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsSource.java"},"S3EventsSource"),"\nassist in reading data from S3 reliably and efficiently ingesting that to Hudi. Existing approach using ",(0,n.kt)("inlineCode",{parentName:"p"},"*DFSSource")," source classes uses last modification time of files as checkpoint to pull in new files.\nBut, if large number of files have the same modification time, this might miss some files to be read from the source.  These two sources (S3EventsHoodieIncrSource and S3EventsSource) together ensures data\nis reliably ingested from S3 into Hudi by leveraging AWS SNS and SQS services that subscribes to file events from the source bucket. ",(0,n.kt)("a",{parentName:"p",href:"/blog/2021/08/23/s3-events-source"},"This blog post")," presents a model for\nscalable, reliable incremental ingestion by using these two sources in tandem."),(0,n.kt)("p",null,"In addition to pulling events from kafka using regular offset format, we also added support for timestamp based fetches, that can\nhelp with initial backfill/bootstrap scenarios. We have also added support for passing in basic auth credentials in schema registry provider url with schema provider."),(0,n.kt)("h2",{id:"raw-release-notes-5"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12350027"},"here")),(0,n.kt)("h2",{id:"release-080-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.8.0"},"Release 0.8.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.8.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-for-this-release-1"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If migrating from release older than 0.5.3, please also check the upgrade instructions for each subsequent release below."),(0,n.kt)("li",{parentName:"ul"},"Specifically check upgrade instructions for 0.6.0. This release does not introduce any new table versions."),(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieRecordPayload")," interface deprecated existing methods, in favor of new ones that also lets us pass properties at runtime. Users are\nencouraged to migrate out of the deprecated methods, since they will be removed in 0.9.0."),(0,n.kt)("li",{parentName:"ul"},'"auto.offset.reset" is a config used for Kafka sources in deltastreamer utility to reset offset to be consumed from such\nsources. We had a bug around this config with 0.8.0 which has been fixed in 0.9.0. Please use "auto.reset.offsets" instead.\nPossible values for this config are "earliest" and "latest"(default). So, would recommend using "auto.reset.offsets" only in\n0.8.0 and for all other releases, you can use "auto.offset.reset".')),(0,n.kt)("h2",{id:"release-highlights-6"},"Release Highlights"),(0,n.kt)("h3",{id:"flink-integration"},"Flink Integration"),(0,n.kt)("p",null,"Since the initial support for the Hudi Flink Writer in the 0.7.0 release, the Hudi community made great progress on improving the Flink/Hudi integration,\nincluding redesigning the Flink writer pipeline with better performance and scalability, state-backed indexing with bootstrap support,\nFlink writer for MOR table, batch reader for COW&MOR table, streaming reader for MOR table, and Flink SQL connector for both source and sink.\nIn the 0.8.0 release, user is able to use all those features with Flink 1.11+."),(0,n.kt)("p",null,"Please see ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+24%3A+Hoodie+Flink+Writer+Proposal"},"RFC-24"),"\nfor more implementation details for the Flink writer and follow this ",(0,n.kt)("a",{parentName:"p",href:"/docs/flink-quick-start-guide"},"page"),"\nto get started with Flink!"),(0,n.kt)("h3",{id:"parallel-writers-support"},"Parallel Writers Support"),(0,n.kt)("p",null,"As many users requested, now Hudi supports multiple ingestion writers to the same Hudi Table with optimistic concurrency control.\nHudi supports file level OCC, i.e., for any 2 commits (or writers) happening to the same table, if they do not have writes to overlapping files being changed,\nboth writers are allowed to succeed. This feature is currently experimental and requires either Zookeeper or HiveMetastore to acquire locks."),(0,n.kt)("p",null,"Please see ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+22+%3A+Snapshot+Isolation+using+Optimistic+Concurrency+Control+for+multi-writers"},"RFC-22"),"\nfor more implementation details and follow this ",(0,n.kt)("a",{parentName:"p",href:"/docs/concurrency_control"},"page")," to get started with concurrency control!"),(0,n.kt)("h3",{id:"writer-side-improvements-2"},"Writer side improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"InsertOverwrite Support for Flink writer client."),(0,n.kt)("li",{parentName:"ul"},"Support CopyOnWriteTable in Java writer client.")),(0,n.kt)("h3",{id:"query-side-improvements-2"},"Query side improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Support Spark Structured Streaming read from Hudi table."),(0,n.kt)("li",{parentName:"ul"},"Performance improvement of Metadata table."),(0,n.kt)("li",{parentName:"ul"},"Performance improvement of Clustering.")),(0,n.kt)("h3",{id:"raw-release-notes-6"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12349423"},"here")),(0,n.kt)("h2",{id:"release-070-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.7.0"},"Release 0.7.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.7.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-for-this-release-2"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If migrating from release older than 0.5.3, please also check the upgrade instructions for each subsequent release below."),(0,n.kt)("li",{parentName:"ul"},"Specifically check upgrade instructions for 0.6.0. This release does not introduce any new table versions."),(0,n.kt)("li",{parentName:"ul"},"The ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieRecordPayload")," interface deprecated existing methods, in favor of new ones that also lets us pass properties at runtime. Users are\nencouraged to migrate out of the deprecated methods, since they will be removed in 0.9.0.")),(0,n.kt)("h2",{id:"release-highlights-7"},"Release Highlights"),(0,n.kt)("h3",{id:"clustering"},"Clustering"),(0,n.kt)("p",null,"0.7.0 brings the ability to cluster your Hudi tables, to optimize for file sizes and also storage layout. Hudi will continue to\nenforce file sizes, as it always has been, during the write. Clustering provides more flexibility to increase the file sizes\ndown the line or ability to ingest data at much fresher intervals, and later coalesce them into bigger files. ",(0,n.kt)("a",{parentName:"p",href:"https://gist.github.com/vinothchandar/d7fa1338cddfae68390afcdfe310f94e#gistcomment-3383478"},"Microbenchmarks"),"\ndemonstrate a 3-4x reduction in query performance, for a 10-20x reduction in file sizes."),(0,n.kt)("p",null,"Additionally, clustering data based on fields that are often used in queries, dramatically\n",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+19+Clustering+data+for+freshness+and+query+performance#RFC19Clusteringdataforfreshnessandqueryperformance-PerformanceEvaluation"},"improves query performance")," by allowing many files to be\ncompletely skipped. This is very similar to the benefits of clustering delivered by ",(0,n.kt)("a",{parentName:"p",href:"https://docs.snowflake.com/en/user-guide/tables-clustering-micropartitions"},"cloud data warehouses"),".\nWe are proud to announce that such capability is freely available in open source, for the first time, through the 0.7.0 release."),(0,n.kt)("p",null,"Please see ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+19+Clustering+data+for+freshness+and+query+performance"},"RFC-19")," for more implementation details\nand checkout configs ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#clustering-configs"},"here")," for how to use it in your pipelines. At the moment, we support both inline and async clustering modes."),(0,n.kt)("h3",{id:"metadata-table-1"},"Metadata Table"),(0,n.kt)("p",null,"Since Hudi was born at Uber, on a HDFS backed data lake, we have since been a tad apathetic to the plight of listing performance on cloud storage (partly in hopes that\ncloud providers will fix it over time:)). Nonetheless, 0.7.0 changes this and lays out the foundation for storing more indexes, metadata in an internal metadata table,\nwhich is implemented using a Hudi MOR table - which means it's compacted, cleaned and also incrementally updated like any other Hudi table. Also, unlike similar\nimplementations in other projects, we have chosen to index the file listing information as HFiles, which offers point-lookup performance to fetch listings for a single partition."),(0,n.kt)("p",null,"In 0.7.0 release, ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.metadata.enable=true")," on the writer side, will populate the metadata table with file system listings\nso all operations don't have to explicitly use ",(0,n.kt)("inlineCode",{parentName:"p"},"fs.listStatus()")," anymore on data partitions. We have introduced a sync mechanism that\nkeeps syncing file additions/deletions on the data timeline, to the metadata table, after each write operation."),(0,n.kt)("p",null,"In our testing, on a large 250K file table, the metadata table delivers ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/pull/2441#issuecomment-761742963"},"2-3x speedup")," over parallelized\nlisting done by the Hudi spark writer. Please check ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+15%3A+HUDI+File+Listing+and+Query+Planning+Improvements"},"RFC-15 (ongoing)"),"\nand the ",(0,n.kt)("a",{parentName:"p",href:"/docs/configurations#metadata-config"},"configurations"),", which offer flags to help adopt this feature safely in your production pipelines."),(0,n.kt)("h3",{id:"javaflink-writers"},"Java/Flink Writers"),(0,n.kt)("p",null,"Hudi was originally designed with a heavy dependency on Spark, given it had simply solve specific problems at Uber. But, as we have evolved as an Apache\nproject, we realized the need for abstracting the internal table format, table services and writing layers of code. In 0.7.0, we have additionally added\nJava and Flink based writers, as initial steps in this direction."),(0,n.kt)("p",null,"Specifically, the ",(0,n.kt)("inlineCode",{parentName:"p"},"HoodieFlinkStreamer")," allows for Hudi Copy-On-Write table to built by streaming data from a Kafka topic."),(0,n.kt)("h3",{id:"writer-side-improvements-3"},"Writer side improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Spark3 Support"),": We have added support for writing/querying data using Spark 3. please be sure to use the scala 2.12 hudi-spark-bundle."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Parallelized Listing"),": We have holistically moved all listings under the ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieTableMetadata")," interface, which does multi-threaded/spark parallelized list operations.\nWe expect this to improve cleaner, compaction scheduling performance, even when the metadata table is not used."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Kafka Commit Callbacks"),": We have added ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieWriteCommitKafkaCallback"),", that publishes an event to Apache Kafka, for every commit operation. This can be used to trigger\nderived/ETL pipelines similar to data ",(0,n.kt)("a",{parentName:"li",href:"https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/sensors/index"},"sensors")," in Apache Airflow."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Insert Overwrite/Insert Overwrite Table"),": We have added these two new write operation types, predominantly to help existing batch ETL jobs, which typically overwrite entire\ntables/partitions each run. These operations are much cheaper, than having to issue upserts, given they are bulk replacing the target table.\nCheck ",(0,n.kt)("a",{parentName:"li",href:"/docs/quick-start-guide#insert-overwrite-table"},"here")," for examples."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Delete Partition"),": For users of WriteClient/RDD level apis, we have added an API to delete an entire partition, again without issuing deletes at the record level."),(0,n.kt)("li",{parentName:"ul"},"The current default ",(0,n.kt)("inlineCode",{parentName:"li"},"OverwriteWithLatestAvroPayload")," will overwrite the value in storage, even if for e.g the upsert was reissued for an older value of the key.\nAdded a new ",(0,n.kt)("inlineCode",{parentName:"li"},"DefaultHoodieRecordPayload")," and a new payload config ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.payload.ordering.field")," helps specify a field, that the incoming upsert record can be compared with\nthe record on storage, to decide whether to overwrite or not. Users are encouraged to adopt this newer, more flexible model."),(0,n.kt)("li",{parentName:"ul"},"Hive sync supports hourly partitions via ",(0,n.kt)("inlineCode",{parentName:"li"},"SlashEncodedHourPartitionValueExtractor")),(0,n.kt)("li",{parentName:"ul"},"Support for IBM Cloud storage, Open J9 JVM.")),(0,n.kt)("h3",{id:"query-side-improvements-3"},"Query side improvements"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Incremental Query on MOR (Spark Datasource)"),": Spark datasource now has experimental support for incremental queries on MOR table. This feature will be hardened and certified\nin the next release, along with a large overhaul of the spark datasource implementation. (sshh!:))"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Metadata Table For File Listings"),": Users can also leverage the metadata table on the query side for the following query paths. For Hive, setting the ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.metadata.enable=true")," session\nproperty and for SparkSQL on Hive registered tables using ",(0,n.kt)("inlineCode",{parentName:"li"},"--conf spark.hadoop.hoodie.metadata.enable=true"),", allows the file listings for the partition to be fetched out of the metadata\ntable, instead of listing the underlying DFS partition.")),(0,n.kt)("h3",{id:"raw-release-notes-7"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12348721"},"here")),(0,n.kt)("h2",{id:"release-060-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.6.0"},"Release 0.6.0")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.6.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-for-this-release-3"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"If migrating from release older than 0.5.3, please also check the upgrade instructions for each subsequent release below."),(0,n.kt)("li",{parentName:"ul"},"With 0.6.0 Hudi is moving from list based rollback to marker based rollbacks. To smoothly aid this transition a\nnew property called ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.table.version")," is added to ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.properties")," file. Whenever Hudi is launched with\nnewer table version i.e 1 (or moving from pre 0.6.0 to 0.6.0), an upgrade step will be executed automatically.\nThis automatic upgrade step will happen just once per Hudi table as the ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.table.version")," will be updated in property file after upgrade is completed."),(0,n.kt)("li",{parentName:"ul"},"Similarly, a command line tool for Downgrading (command - ",(0,n.kt)("inlineCode",{parentName:"li"},"downgrade"),") is added if in case some users want to downgrade Hudi from table version 1 to 0 or move from Hudi 0.6.0 to pre 0.6.0"),(0,n.kt)("li",{parentName:"ul"},"If you were using a user defined partitioner with bulkInsert() RDD API, the base interface has changed to ",(0,n.kt)("inlineCode",{parentName:"li"},"BulkInsertPartitioner")," and will need minor adjustments to your existing implementations.")),(0,n.kt)("h2",{id:"release-highlights-8"},"Release Highlights"),(0,n.kt)("h3",{id:"writer-side-improvements-4"},"Writer side improvements:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Bootstrapping existing parquet datasets :  Adds support for bootstrapping existing datasets into Hudi, via both Spark datasource writer and\ndeltastreamer tool, with support for reading from Hive, SparkSQL, AWS Athena (prestoDB support coming soon). See ",(0,n.kt)("a",{parentName:"li",href:"https://cwiki.apache.org/confluence/display/HUDI/RFC+-+15%3A+HUDI+File+Listing+and+Query+Planning+Improvements"},"RFC-15")," for technical details.\nNote that this is an experimental feature, which will be improved upon further in the 0.6.x versions."),(0,n.kt)("li",{parentName:"ul"},"Native row writing for bulk_insert : Avoids any dataframe-rdd conversion for bulk_insert path, which can improve performance of initial bulk loads.\nAlthough, this is typically not the bottleneck for upsert/deletes, subsequent releases in 0.6.x versions will expand this to other write operations\nto make reasoning about schema management easier, avoiding the spark-avro conversion totally."),(0,n.kt)("li",{parentName:"ul"},"Bulk insert sort modes : Hudi bulk_insert sorts the input globally to optimize file sizes and avoid out-of-memory issues encountered when writing parallely to multiple DFS partitions.\nFor users who want to prepare the dataframe for writing outside of Hudi, we have made this configurable using ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.bulkinsert.sort.mode"),"."),(0,n.kt)("li",{parentName:"ul"},"Cleaning can now be run concurrently with writing, using ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.clean.async=true"),"which can speed up time taken to finish committing."),(0,n.kt)("li",{parentName:"ul"},"Async compaction for spark streaming writes to hudi table, is now self managed by default, controlling ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.compaction.async.enable"),"."),(0,n.kt)("li",{parentName:"ul"},"Rollbacks no longer perform full table listings, by leveraging marker files. To enable, set ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.rollback.using.markers=true"),"."),(0,n.kt)("li",{parentName:"ul"},"Added a new index ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.index.type=SIMPLE")," which can be faster than ",(0,n.kt)("inlineCode",{parentName:"li"},"BLOOM_INDEX")," for cases where updates/deletes spread across a large portion of the table."),(0,n.kt)("li",{parentName:"ul"},"Hudi now supports ",(0,n.kt)("inlineCode",{parentName:"li"},"Azure Data Lake Storage V2")," , ",(0,n.kt)("inlineCode",{parentName:"li"},"Alluxio")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"Tencent Cloud Object Storage")," storages."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/writing_data#multitabledeltastreamer"},"HoodieMultiDeltaStreamer")," adds support for ingesting multiple kafka streams in a single DeltaStreamer deployment, effectively reducing operational burden for using delta streamer\nas your data lake ingestion tool (Experimental feature)"),(0,n.kt)("li",{parentName:"ul"},"Added a new tool - InitialCheckPointProvider, to set checkpoints when migrating to DeltaStreamer after an initial load of the table is complete."),(0,n.kt)("li",{parentName:"ul"},"Delta Streamer tool now supports ingesting CSV data sources, chaining of multiple transformers to build more advanced ETL jobs."),(0,n.kt)("li",{parentName:"ul"},"Introducing a new ",(0,n.kt)("inlineCode",{parentName:"li"},"CustomKeyGenerator")," key generator class, that provides flexible configurations to provide enable different types of key, partition path generation in  single class.\nWe also added support for more time units and date/time formats in ",(0,n.kt)("inlineCode",{parentName:"li"},"TimestampBasedKeyGenerator"),". See ",(0,n.kt)("a",{parentName:"li",href:"https://hudi.apache.org/docs/writing_data#key-generation"},"docs")," for more.")),(0,n.kt)("h3",{id:"query-side-improvements-4"},"Query side improvements:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Starting 0.6.0, snapshot queries are feasible on MOR tables using spark datasource. (experimental feature)"),(0,n.kt)("li",{parentName:"ul"},"In prior versions we only supported ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieCombineHiveInputFormat")," for CopyOnWrite tables to ensure that there is a limit on the number of mappers spawned for\nany query. Hudi now supports Merge on Read tables also using ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieCombineInputFormat"),"."),(0,n.kt)("li",{parentName:"ul"},"Speedup spark read queries by caching metaclient in HoodieROPathFilter. This helps reduce listing related overheads in S3 when filtering files for read-optimized queries.")),(0,n.kt)("h3",{id:"usability"},"Usability:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Spark DAGs are named to aid better debuggability."),(0,n.kt)("li",{parentName:"ul"},"Support pluggable metrics reporting by introducing proper abstraction for user defined metrics. Console, JMX, Prometheus and DataDog metric reporters have been added."),(0,n.kt)("li",{parentName:"ul"},"A new utility called Data snapshot exporter has been added. Latest table snapshot as of a certain point in time can be exported as plain parquet files with this tool."),(0,n.kt)("li",{parentName:"ul"},"Introduce write committed callback hooks for incremental pipelines to be notified and act on new commits in the timeline. For e.g, Apache Airflow jobs can be triggered\nas new commits arrive."),(0,n.kt)("li",{parentName:"ul"},"Added support for deleting savepoints via CLI"),(0,n.kt)("li",{parentName:"ul"},"Added a new command - ",(0,n.kt)("inlineCode",{parentName:"li"},"export instants"),", to export metadata of instants")),(0,n.kt)("h2",{id:"raw-release-notes-8"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12346663"},"here")),(0,n.kt)("h2",{id:"release-053-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.5.3"},"Release 0.5.3")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.5.3/quick-start-guide"},"docs"),")"),(0,n.kt)("h2",{id:"migration-guide-for-this-release-4"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"This is a bug fix only release and no special migration steps needed when upgrading from 0.5.2. If you are upgrading from earlier releases \u201cX\u201d, please make sure you read the migration guide for each subsequent release between \u201cX\u201d and 0.5.3"),(0,n.kt)("li",{parentName:"ul"},'0.5.3 is the first hudi release after graduation. As a result, all hudi jars will no longer have "-incubating" in the version name. In all the places where hudi version is referred, please make sure "-incubating" is no longer present.')),(0,n.kt)("p",null,"For example hudi-spark-bundle pom dependency would look like:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-xml"},"    <dependency>\n        <groupId>org.apache.hudi</groupId>\n        <artifactId>hudi-spark-bundle_2.12</artifactId>\n        <version>0.5.3</version>\n    </dependency>\n")),(0,n.kt)("h2",{id:"release-highlights-9"},"Release Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Hudi now supports ",(0,n.kt)("inlineCode",{parentName:"li"},"aliyun OSS")," storage service."),(0,n.kt)("li",{parentName:"ul"},"Embedded Timeline Server is enabled by default for both delta-streamer and spark datasource writes. This feature was in experimental mode before this release. Embedded Timeline Server caches file listing calls in Spark driver and serves them to Spark writer tasks. This reduces the number of file listings needed to be performed for each write."),(0,n.kt)("li",{parentName:"ul"},"Incremental Cleaning is enabled by default for both delta-streamer and spark datasource writes. This feature was also in experimental mode before this release. In the steady state, incremental cleaning avoids the costly step of scanning all partitions and instead uses Hudi metadata to find files to be cleaned up."),(0,n.kt)("li",{parentName:"ul"},"Delta-streamer config files can now be placed in different filesystem than actual data."),(0,n.kt)("li",{parentName:"ul"},"Hudi Hive Sync now supports tables partitioned by date type column."),(0,n.kt)("li",{parentName:"ul"},"Hudi Hive Sync now supports syncing directly via Hive MetaStore. You simply need to set hoodie.datasource.hive_sync.use_jdbc\n=false. Hive Metastore Uri will be read implicitly from environment. For example, when writing through Spark Data Source,")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-Scala"}," spark.write.format(\u201chudi\u201d)\n .option(\u2026)\n .option(\u201choodie.datasource.hive_sync.username\u201d, \u201c<user>\u201d)\n .option(\u201choodie.datasource.hive_sync.password\u201d, \u201c<password>\u201d)\n .option(\u201choodie.datasource.hive_sync.partition_fields\u201d, \u201c<partition_fields>\u201d)\n .option(\u201choodie.datasource.hive_sync.database\u201d, \u201c<db_name>\u201d)\n .option(\u201choodie.datasource.hive_sync.table\u201d, \u201c<table_name>\u201d)\n .option(\u201choodie.datasource.hive_sync.use_jdbc\u201d, \u201cfalse\u201d)\n .mode(APPEND)\n .save(\u201c/path/to/dataset\u201d)\n")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Other Writer Performance related fixes:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"DataSource Writer now avoids unnecessary loading of data after write."),(0,n.kt)("li",{parentName:"ul"},"Hudi Writer now leverages spark parallelism when searching for existing files for writing new records.")))),(0,n.kt)("h2",{id:"raw-release-notes-9"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12348256"},"here")),(0,n.kt)("h2",{id:"release-052-incubating-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.5.2-incubating"},"Release 0.5.2-incubating")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.5.2/quick-start-guide"},"docs"),")"),(0,n.kt)("h3",{id:"migration-guide-for-this-release-5"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Write Client restructuring has moved classes around (",(0,n.kt)("a",{parentName:"li",href:"https://issues.apache.org/jira/browse/HUDI-554"},"HUDI-554"),"). Package ",(0,n.kt)("inlineCode",{parentName:"li"},"client")," now has all the various client classes, that do the transaction management. ",(0,n.kt)("inlineCode",{parentName:"li"},"func")," renamed to ",(0,n.kt)("inlineCode",{parentName:"li"},"execution")," and some helpers moved to ",(0,n.kt)("inlineCode",{parentName:"li"},"client/utils"),". All compaction code under ",(0,n.kt)("inlineCode",{parentName:"li"},"io")," now under ",(0,n.kt)("inlineCode",{parentName:"li"},"table/compact"),". Rollback code under ",(0,n.kt)("inlineCode",{parentName:"li"},"table/rollback")," and in general all code for individual operations under ",(0,n.kt)("inlineCode",{parentName:"li"},"table"),". This change only affects the apps/projects depending on hudi-client. Users of deltastreamer/datasource will not need to change anything.")),(0,n.kt)("h3",{id:"release-highlights-10"},"Release Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Support for overwriting the payload implementation in ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.properties")," via specifying the ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.compaction.payload.class")," config option. Previously, once the payload class is set once in ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.properties"),", it cannot be changed. In some cases, if a code refactor is done and the jar updated, one may need to pass the new payload class name."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TimestampBasedKeyGenerator")," supports for ",(0,n.kt)("inlineCode",{parentName:"li"},"CharSequence"),"  types. Previously ",(0,n.kt)("inlineCode",{parentName:"li"},"TimestampBasedKeyGenerator")," only supports ",(0,n.kt)("inlineCode",{parentName:"li"},"Double"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Long"),", ",(0,n.kt)("inlineCode",{parentName:"li"},"Float")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"String")," 4 data types for the partition key. Now, after data type extending, ",(0,n.kt)("inlineCode",{parentName:"li"},"CharSequence")," has been supported in ",(0,n.kt)("inlineCode",{parentName:"li"},"TimestampBasedKeyGenerator"),"."),(0,n.kt)("li",{parentName:"ul"},"Hudi now supports incremental pulling from defined partitions via the ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.datasource.read.incr.path.glob")," ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/blob/master/hudi-spark/src/main/scala/org/apache/hudi/DataSourceOptions.scala#L111"},"config option"),". For some use case that users only need to pull the incremental part of certain partitions, it can run faster by only loading relevant parquet files."),(0,n.kt)("li",{parentName:"ul"},"With 0.5.2, hudi allows partition path to be updated with ",(0,n.kt)("inlineCode",{parentName:"li"},"GLOBAL_BLOOM")," index. Previously, when a record is to be updated with a new partition path, and when set to ",(0,n.kt)("inlineCode",{parentName:"li"},"GLOBAL_BLOOM")," as index, hudi ignores the new partition path and update the record in the original partition path. Now, hudi allows records to be inserted into their new partition paths and delete the records in the old partition paths. A configuration (e.g. ",(0,n.kt)("inlineCode",{parentName:"li"},"hoodie.index.bloom.update.partition.path=true"),") can be added to enable this feature."),(0,n.kt)("li",{parentName:"ul"},"A ",(0,n.kt)("inlineCode",{parentName:"li"},"JdbcbasedSchemaProvider")," schema provider has been provided to get metadata through JDBC. For the use case that users want to synchronize data from MySQL, and at the same time, want to get the schema from the database, it's very helpful."),(0,n.kt)("li",{parentName:"ul"},"Simplify ",(0,n.kt)("inlineCode",{parentName:"li"},"HoodieBloomIndex")," without the need for 2GB limit handling. Prior to spark 2.4.0, each spark partition has a limit of 2GB. In Hudi 0.5.1, after we upgraded to spark 2.4.4, we don't have the limitation anymore. Hence removing the safe parallelism constraint we had in",(0,n.kt)("inlineCode",{parentName:"li"}," HoodieBloomIndex"),"."),(0,n.kt)("li",{parentName:"ul"},"CLI related changes:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Allows users to specify option to print additional commit metadata, e.g. ",(0,n.kt)("em",{parentName:"li"},"Total Log Blocks"),", ",(0,n.kt)("em",{parentName:"li"},"Total Rollback Blocks"),", ",(0,n.kt)("em",{parentName:"li"},"Total Updated Records Compacted")," and so on."),(0,n.kt)("li",{parentName:"ul"},"Supports ",(0,n.kt)("inlineCode",{parentName:"li"},"temp_query")," and ",(0,n.kt)("inlineCode",{parentName:"li"},"temp_delete")," to query and delete temp view. This command creates a temp table. Users can write HiveQL queries against the table to filter the desired row. For example,")))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"temp_query --sql \"select Instant, NumInserts, NumWrites from satishkotha_debug where FileId='ed33bd99-466f-4417-bd92-5d914fa58a8f' and Instant > '20200123211217' order by Instant\"\n")),(0,n.kt)("h3",{id:"raw-release-notes-10"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12346606"},"here")),(0,n.kt)("h2",{id:"release-051-incubating-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.5.1-incubating"},"Release 0.5.1-incubating")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.5.1/quick-start-guide"},"docs"),")"),(0,n.kt)("h3",{id:"migration-guide-for-this-release-6"},"Migration Guide for this release"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Upgrade hudi readers (query engines) first with 0.5.1-incubating release before upgrading writer."),(0,n.kt)("li",{parentName:"ul"},"In 0.5.1, the community restructured the package of key generators. The key generator related classes have been moved from ",(0,n.kt)("inlineCode",{parentName:"li"},"org.apache.hudi")," to ",(0,n.kt)("inlineCode",{parentName:"li"},"org.apache.hudi.keygen"),".")),(0,n.kt)("h3",{id:"release-highlights-11"},"Release Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Dependency Version Upgrades"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Upgrade from Spark 2.1.0 to Spark 2.4.4"),(0,n.kt)("li",{parentName:"ul"},"Upgrade from Avro 1.7.7 to Avro 1.8.2"),(0,n.kt)("li",{parentName:"ul"},"Upgrade from Parquet 1.8.1 to Parquet 1.10.1"),(0,n.kt)("li",{parentName:"ul"},"Upgrade from Kafka 0.8.2.1 to Kafka 2.0.0 as a result of updating spark-streaming-kafka artifact from 0.8_2.11/2.12 to 0.10_2.11/2.12."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"IMPORTANT")," This version requires your runtime spark version to be upgraded to 2.4+.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Hudi now supports both Scala 2.11 and Scala 2.12, please refer to ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi#build-with-scala-212"},"Build with Scala 2.12")," to build with Scala 2.12.\nAlso, the packages hudi-spark, hudi-utilities, hudi-spark-bundle and hudi-utilities-bundle are changed correspondingly to hudi-spark",(0,n.kt)("em",{parentName:"p"},"{scala_version}, hudi-spark"),"{scala",(0,n.kt)("em",{parentName:"p"},"version}, hudi-utilities"),"{scala",(0,n.kt)("em",{parentName:"p"},"version}, hudi-spark-bundle"),"{scala",(0,n.kt)("em",{parentName:"p"},"version} and hudi-utilities-bundle"),"{scala_version}.\nNote that scala_version here is one of (2.11, 2.12).")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"With 0.5.1, we added functionality to stop using renames for Hudi timeline metadata operations. This feature is automatically enabled for newly created Hudi tables. For existing tables, this feature is turned off by default. Please read this ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/deployment#upgrading"},"section"),', before enabling this feature for existing hudi tables.\nTo enable the new hudi timeline layout which avoids renames, use the write config "hoodie.timeline.layout.version=1". Alternatively, you can use "repair overwrite-hoodie-props" to append the line "hoodie.timeline.layout.version=1" to hoodie.properties. Note that in any case, upgrade hudi readers (query engines) first with 0.5.1-incubating release before upgrading writer.')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"CLI supports ",(0,n.kt)("inlineCode",{parentName:"p"},"repair overwrite-hoodie-props")," to overwrite the table's hoodie.properties with specified file, for one-time updates to table name or even enabling the new timeline layout above. Note that few queries may temporarily fail while the overwrite happens (few milliseconds).")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"DeltaStreamer CLI parameter for capturing table type is changed from ",(0,n.kt)("inlineCode",{parentName:"p"},"--storage-type")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"--table-type"),". Refer to ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/Design+And+Architecture"},"wiki")," with more latest terminologies.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Configuration Value change for Kafka Reset Offset Strategies. Enum values are changed from LARGEST to LATEST, SMALLEST to EARLIEST for configuring Kafka reset offset strategies with configuration(auto.offset.reset) in deltastreamer.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"When using spark-shell to give a quick peek at Hudi, please provide ",(0,n.kt)("inlineCode",{parentName:"p"},"--packages org.apache.spark:spark-avro_2.11:2.4.4"),", more details would refer to ",(0,n.kt)("a",{parentName:"p",href:"https://hudi.apache.org/docs/quick-start-guide"},"latest quickstart docs"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},'Key generator moved to separate package under org.apache.hudi.keygen. If you are using overridden key generator classes (configuration ("hoodie.datasource.write.keygenerator.class")) that comes with hudi package, please ensure the fully qualified class name is changed accordingly.')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Hive Sync tool will register RO tables for MOR with a _ro suffix, so query with _ro suffix. You would use ",(0,n.kt)("inlineCode",{parentName:"p"},"--skip-ro-suffix")," in sync config in sync config to retain the old naming without the _ro suffix.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"With 0.5.1, hudi-hadoop-mr-bundle which is used by query engines such as presto and hive includes shaded avro package to support hudi real time queries through these engines. Hudi supports pluggable logic for merging of records. Users provide their own implementation of ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/apache/hudi/blob/master/hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordPayload.java"},"HoodieRecordPayload"),".\nIf you are using this feature, you need to relocate the avro dependencies in your custom record payload class to be consistent with internal hudi shading. You need to add the following relocation when shading the package containing the record payload implementation."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-xml"},"<relocation>\n  <pattern>org.apache.avro.</pattern>\n  <shadedPattern>org.apache.hudi.org.apache.avro.</shadedPattern>\n</relocation>\n"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Better delete support in DeltaStreamer, please refer to ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/2020/01/15/Delete+support+in+Hudi"},"blog")," for more info.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Support for AWS Database Migration Service(DMS) in DeltaStreamer, please refer to ",(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/2020/01/20/Change+Capture+Using+AWS+Database+Migration+Service+and+Hudi"},"blog")," for more info.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Support for DynamicBloomFilter. This is turned off by default, to enable the DynamicBloomFilter, please use the index config ",(0,n.kt)("inlineCode",{parentName:"p"},"hoodie.bloom.index.filter.type=DYNAMIC_V0"),"."))),(0,n.kt)("h3",{id:"raw-release-notes-11"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12346183"},"here")),(0,n.kt)("h2",{id:"release-050-incubating-docs"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/release-0.5.0-incubating"},"Release 0.5.0-incubating")," (",(0,n.kt)("a",{parentName:"h2",href:"/docs/0.5.0/quick-start-guide"},"docs"),")"),(0,n.kt)("h3",{id:"release-highlights-12"},"Release Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Package and format renaming from com.uber.hoodie to org.apache.hudi (See migration guide section below)"),(0,n.kt)("li",{parentName:"ul"},"Major redo of Hudi bundles to address class and jar version mismatches in different environments"),(0,n.kt)("li",{parentName:"ul"},"Upgrade from Hive 1.x to Hive 2.x for compile time dependencies - Hive 1.x runtime integration still works with a patch : See ",(0,n.kt)("a",{parentName:"li",href:"https://lists.apache.org/thread/48b3f0553f47c576fd7072f56bb0d8a24fb47d4003880d179c7f88a3@%3Cdev.hudi.apache.org%3E"},"the discussion thread")),(0,n.kt)("li",{parentName:"ul"},"DeltaStreamer now supports continuous running mode with managed concurrent compaction"),(0,n.kt)("li",{parentName:"ul"},"Support for Composite Keys as record key"),(0,n.kt)("li",{parentName:"ul"},"HoodieCombinedInputFormat to scale huge hive queries running on Hoodie tables")),(0,n.kt)("h3",{id:"migration-guide-for-this-release-7"},"Migration Guide for this release"),(0,n.kt)("p",null,'This is the first Apache release for Hudi. Prior to this release, Hudi Jars were published using "com.uber.hoodie" maven co-ordinates. We have a ',(0,n.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/HUDI/Migration+Guide+From+com.uber.hoodie+to+org.apache.hudi"},"migration guide")),(0,n.kt)("h3",{id:"raw-release-notes-12"},"Raw Release Notes"),(0,n.kt)("p",null,"The raw release notes are available ",(0,n.kt)("a",{parentName:"p",href:"https://jira.apache.org/jira/secure/ReleaseNote.jspa?projectId=12322822&version=12346087"},"here")),(0,n.kt)("h2",{id:"release-047"},(0,n.kt)("a",{parentName:"h2",href:"https://github.com/apache/hudi/releases/tag/hoodie-0.4.7"},"Release 0.4.7")),(0,n.kt)("h3",{id:"release-highlights-13"},"Release Highlights"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Major releases with fundamental changes to filesystem listing & write failure handling"),(0,n.kt)("li",{parentName:"ul"},"Introduced the first version of HoodieTimelineServer that runs embedded on the driver"),(0,n.kt)("li",{parentName:"ul"},"With all executors fetching filesystem listing via RPC to timeline server, drastically reduced filesystem listing!"),(0,n.kt)("li",{parentName:"ul"},"Failing concurrent write tasks are now handled differently to be robust against spark stage retries"),(0,n.kt)("li",{parentName:"ul"},"Bug fixes/clean up around indexing, compaction")),(0,n.kt)("h3",{id:"pr-list"},"PR LIST"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Skip Meta folder when looking for partitions. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/698"},"#698")),(0,n.kt)("li",{parentName:"ul"},"HUDI-134 - Disable inline compaction for Hoodie Demo. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/696"},"#696")),(0,n.kt)("li",{parentName:"ul"},"Default implementation for HBase index qps allocator. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/685"},"#685")),(0,n.kt)("li",{parentName:"ul"},"Handle duplicate record keys across partitions. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/687"},"#687")),(0,n.kt)("li",{parentName:"ul"},"Fix up offsets not available on leader exception. ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/apache/hudi/pull/650"},"#650"))))}u.isMDXComponent=!0}}]);